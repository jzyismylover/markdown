<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>rust | Mr.Jiang-技术博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="">
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?2675818a983a3131404cee835018f016";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script>
    <meta name="description" content="学习&amp;工作-技术积累">
    
    <link rel="preload" href="/markdown/assets/css/0.styles.5474aed4.css" as="style"><link rel="preload" href="/markdown/assets/js/app.085aa012.js" as="script"><link rel="preload" href="/markdown/assets/js/2.773263cd.js" as="script"><link rel="preload" href="/markdown/assets/js/41.afe775e0.js" as="script"><link rel="prefetch" href="/markdown/assets/js/1.50bc9635.js"><link rel="prefetch" href="/markdown/assets/js/10.121e7e8f.js"><link rel="prefetch" href="/markdown/assets/js/11.5205ffab.js"><link rel="prefetch" href="/markdown/assets/js/12.fef29d74.js"><link rel="prefetch" href="/markdown/assets/js/13.b581db50.js"><link rel="prefetch" href="/markdown/assets/js/14.07202c28.js"><link rel="prefetch" href="/markdown/assets/js/15.9aedb95a.js"><link rel="prefetch" href="/markdown/assets/js/16.dd97e264.js"><link rel="prefetch" href="/markdown/assets/js/17.8eb943fb.js"><link rel="prefetch" href="/markdown/assets/js/18.942cde78.js"><link rel="prefetch" href="/markdown/assets/js/19.44710683.js"><link rel="prefetch" href="/markdown/assets/js/20.22d46747.js"><link rel="prefetch" href="/markdown/assets/js/21.aa8b4011.js"><link rel="prefetch" href="/markdown/assets/js/22.b40024cc.js"><link rel="prefetch" href="/markdown/assets/js/23.ace5d346.js"><link rel="prefetch" href="/markdown/assets/js/24.2405d60a.js"><link rel="prefetch" href="/markdown/assets/js/25.c08a85e2.js"><link rel="prefetch" href="/markdown/assets/js/26.c4c5f267.js"><link rel="prefetch" href="/markdown/assets/js/27.b91e5849.js"><link rel="prefetch" href="/markdown/assets/js/28.b80c3633.js"><link rel="prefetch" href="/markdown/assets/js/29.594ec447.js"><link rel="prefetch" href="/markdown/assets/js/3.9d4223ad.js"><link rel="prefetch" href="/markdown/assets/js/30.324e278d.js"><link rel="prefetch" href="/markdown/assets/js/31.43dc2191.js"><link rel="prefetch" href="/markdown/assets/js/32.3fb01abd.js"><link rel="prefetch" href="/markdown/assets/js/33.5a2693b9.js"><link rel="prefetch" href="/markdown/assets/js/34.637d4661.js"><link rel="prefetch" href="/markdown/assets/js/35.eccfebaa.js"><link rel="prefetch" href="/markdown/assets/js/36.c13df5f5.js"><link rel="prefetch" href="/markdown/assets/js/37.9890e89c.js"><link rel="prefetch" href="/markdown/assets/js/38.b33827f2.js"><link rel="prefetch" href="/markdown/assets/js/39.3a1ace37.js"><link rel="prefetch" href="/markdown/assets/js/4.27d6f5b1.js"><link rel="prefetch" href="/markdown/assets/js/40.4396d4c2.js"><link rel="prefetch" href="/markdown/assets/js/42.19b2951c.js"><link rel="prefetch" href="/markdown/assets/js/43.7c3256ea.js"><link rel="prefetch" href="/markdown/assets/js/44.7da308e4.js"><link rel="prefetch" href="/markdown/assets/js/45.89b2fd21.js"><link rel="prefetch" href="/markdown/assets/js/46.e817e45d.js"><link rel="prefetch" href="/markdown/assets/js/47.c56ee626.js"><link rel="prefetch" href="/markdown/assets/js/48.59541039.js"><link rel="prefetch" href="/markdown/assets/js/49.bc7ad96a.js"><link rel="prefetch" href="/markdown/assets/js/5.2637f2cc.js"><link rel="prefetch" href="/markdown/assets/js/50.9d0dc446.js"><link rel="prefetch" href="/markdown/assets/js/51.4d949834.js"><link rel="prefetch" href="/markdown/assets/js/52.90aa4f80.js"><link rel="prefetch" href="/markdown/assets/js/53.67b77129.js"><link rel="prefetch" href="/markdown/assets/js/54.3535db37.js"><link rel="prefetch" href="/markdown/assets/js/55.9efbe9e5.js"><link rel="prefetch" href="/markdown/assets/js/56.e8aa37ba.js"><link rel="prefetch" href="/markdown/assets/js/57.af66ff8f.js"><link rel="prefetch" href="/markdown/assets/js/58.0415674f.js"><link rel="prefetch" href="/markdown/assets/js/59.b09373ca.js"><link rel="prefetch" href="/markdown/assets/js/6.61bacfb8.js"><link rel="prefetch" href="/markdown/assets/js/60.d07cb515.js"><link rel="prefetch" href="/markdown/assets/js/61.ec2b2da7.js"><link rel="prefetch" href="/markdown/assets/js/62.44a5a0b8.js"><link rel="prefetch" href="/markdown/assets/js/63.09e39adc.js"><link rel="prefetch" href="/markdown/assets/js/64.b9ee085d.js"><link rel="prefetch" href="/markdown/assets/js/65.026450b0.js"><link rel="prefetch" href="/markdown/assets/js/66.a3571972.js"><link rel="prefetch" href="/markdown/assets/js/67.5a8616c4.js"><link rel="prefetch" href="/markdown/assets/js/68.6fdda787.js"><link rel="prefetch" href="/markdown/assets/js/69.691ff5d7.js"><link rel="prefetch" href="/markdown/assets/js/7.32a4bd87.js"><link rel="prefetch" href="/markdown/assets/js/70.b401009e.js"><link rel="prefetch" href="/markdown/assets/js/71.6b3bcefe.js"><link rel="prefetch" href="/markdown/assets/js/72.dcd8145e.js"><link rel="prefetch" href="/markdown/assets/js/73.cc81c046.js"><link rel="prefetch" href="/markdown/assets/js/74.856f40f0.js"><link rel="prefetch" href="/markdown/assets/js/75.746590de.js"><link rel="prefetch" href="/markdown/assets/js/76.8ddba5b5.js"><link rel="prefetch" href="/markdown/assets/js/77.16644476.js"><link rel="prefetch" href="/markdown/assets/js/78.e89fc885.js"><link rel="prefetch" href="/markdown/assets/js/79.1193b665.js"><link rel="prefetch" href="/markdown/assets/js/80.9475cd89.js"><link rel="prefetch" href="/markdown/assets/js/81.8d99d275.js"><link rel="prefetch" href="/markdown/assets/js/82.80eb3e2f.js"><link rel="prefetch" href="/markdown/assets/js/83.fe14141e.js"><link rel="prefetch" href="/markdown/assets/js/84.9647a2db.js"><link rel="prefetch" href="/markdown/assets/js/85.c7258f01.js"><link rel="prefetch" href="/markdown/assets/js/86.1a5782f4.js"><link rel="prefetch" href="/markdown/assets/js/87.e7354607.js"><link rel="prefetch" href="/markdown/assets/js/vendors~docsearch.54f2532f.js">
    <link rel="stylesheet" href="/markdown/assets/css/0.styles.5474aed4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/markdown/" class="home-link router-link-active"><img src="/markdown/logo.png" alt="Mr.Jiang-技术博客" class="logo"> <span class="site-name can-hide">Mr.Jiang-技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/jzyismylover/ubuntu-markdown" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/jzyismylover/ubuntu-markdown" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>rust</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/markdown/rust/#安装" class="sidebar-link">安装</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#编译过程" class="sidebar-link">编译过程</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#常见编程概念" class="sidebar-link">常见编程概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown/rust/#变量" class="sidebar-link">变量</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#常量" class="sidebar-link">常量</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#数据类型" class="sidebar-link">数据类型</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#标量" class="sidebar-link" style="padding-left:3rem;">标量</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#整型" class="sidebar-link" style="padding-left:4rem;">整型</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#浮点型" class="sidebar-link" style="padding-left:4rem;">浮点型</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#布尔类型" class="sidebar-link" style="padding-left:4rem;">布尔类型</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#字符类型" class="sidebar-link" style="padding-left:4rem;">字符类型</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#复合" class="sidebar-link" style="padding-left:3rem;">复合</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#元组" class="sidebar-link" style="padding-left:4rem;">元组</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#数组" class="sidebar-link" style="padding-left:4rem;">数组</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#函数" class="sidebar-link" style="padding-left:3rem;">函数</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#循环" class="sidebar-link" style="padding-left:3rem;">循环</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#loop" class="sidebar-link" style="padding-left:4rem;">loop</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#while" class="sidebar-link" style="padding-left:4rem;">while</a></li><li class="sidebar-sub-header"><a href="/markdown/rust/#for" class="sidebar-link" style="padding-left:4rem;">for</a></li></ul></li><li><a href="/markdown/rust/#所有权" class="sidebar-link">所有权</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown/rust/#" class="sidebar-link"></a></li></ul></li><li><a href="/markdown/rust/#结构体" class="sidebar-link">结构体</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#枚举" class="sidebar-link">枚举</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#模块" class="sidebar-link">模块</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#vetur" class="sidebar-link">vetur</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#泛型" class="sidebar-link">泛型</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="content"><div class="content-wrapper" style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="rust"><a href="#rust" class="header-anchor">#</a> rust</h1> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>学习资源</p></div> <ul><li><a href="https://github.com/ZhangHanDong/tao-of-rust-codes/blob/master/tao_of_rust_english.md" target="_blank" rel="noopener noreferrer">The Tao of Rust<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/KaiserY/rust-book-chinese" target="_blank" rel="noopener noreferrer">Translation of the official The Rust Programming Language book<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/rust-lang-cn/rust-by-example-cn" target="_blank" rel="noopener noreferrer">Translation of the Rust By Example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/rustcc/RustPrimer" target="_blank" rel="noopener noreferrer">RustPrimer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/RustChina/rust-china.org" target="_blank" rel="noopener noreferrer">Chinese Rust Community<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://askeing.github.io/rust-book/" target="_blank" rel="noopener noreferrer">The book in Traditional Chinese<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/DaseinPhaos/tlborm-chinese" target="_blank" rel="noopener noreferrer">Translation of The Little Book of Rust Macros<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/sunface/rust-course" target="_blank" rel="noopener noreferrer">The Rust Course<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <blockquote><p>以下为在 linux、macos 安装 rust 通用的方法 —— rustup(一个管理 Rust 版本和相关工具的命令行工具。)</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">curl</span> <span class="token parameter variable">--proto</span> <span class="token string">'=https'</span> <span class="token parameter variable">--tlsv1.2</span> https://sh.rustup.rs <span class="token parameter variable">-sSf</span> <span class="token operator">|</span> <span class="token function">sh</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>🔐 实际执行后会经过一系列的选项操作并最后在 <code>.bashrc</code> 里面创建 <code>. &quot;$HOME/.cargo/env&quot;</code>（暴露在环境变量）。如果使用的不是 <code>bash</code> 作为默认终端的话可以将当前配置复制到对应终端的配置环境中，比如 <code>.zshrc</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ rustc <span class="token parameter variable">-V</span> <span class="token comment"># 检查是否安装成功</span>
rustc <span class="token number">1.70</span>.0 <span class="token punctuation">(</span>90c541806 <span class="token number">2023</span>-05-31<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>⚠️ 除此之外还需要安装一个链接器( <code>rustc</code> 依赖 gcc、glibc )，在 ubuntu 中可以通过安装 <code>build-essential</code>，安装的过程会附带安装 <code>G++, dpkg-dev, GCC and make....</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">apt</span> update
$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> build-essential
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>查看本地文档</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ rustup doc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p><code>cargo</code> 可帮助快速初始化 <code>rust</code> 项目，有别于将构建结果放在与源码相同的目录，Cargo 会将其放到 <code>target∕debug</code> 目录</p></blockquote> <ul><li>cargo new 创建项目。</li> <li>cargo build 构建项目。</li> <li>cargo run 一步构建并运行项目。</li> <li>cargo check 在不生成二进制文件的情况下构建项目来检查错误</li></ul> <p>🔐 完成以上环境的安装后，就要配置 IDE (vscode) 编程环境了，主要是安装相关插件</p> <ul><li><code>rust-analyzer</code>：rust 代码补全以及格式化</li> <li><code>even better toml</code>：支持 <code>.toml</code> 文件完整特性</li></ul> <p>🔐 <code>rustrc</code>、<code>rustup</code>、<code>cargo</code> 概念区分</p> <ul><li><code>rustrc</code>：编译器，编译项目代码</li> <li><code>rustup</code>：工具链管理，用于安装 <code>rustrc</code> 版本以及常用组件</li> <li><code>cargo</code>：包管理工具</li></ul> <h2 id="编译过程"><a href="#编译过程" class="header-anchor">#</a> 编译过程</h2> <p><img alt="" data-src="/markdown/assets/img/rust-complie-process.9ce49ba1.png" loading="lazy" class="lazy"></p> <h2 id="常见编程概念"><a href="#常见编程概念" class="header-anchor">#</a> 常见编程概念</h2> <blockquote><p>rust 变量定义、基础语法，包括数据结构.....</p></blockquote> <h3 id="变量"><a href="#变量" class="header-anchor">#</a> 变量</h3> <ul><li>定义一个不可变变量（不能二次赋值）</li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>定义可变变量</li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>🔐 存在一个隐藏变量的概念 —— 可同时使用 <code>let</code> 声明同名变量，后面的覆盖前面的声明。当前变量仍然不可二次修改。</p></blockquote> <p><code>隐藏变量</code> 概念和 <code>mut</code> 的区别</p> <ul><li>前者每次都要加上 <code>let</code> 定义</li> <li>前者定义同名变量时类型可不一致（实际上是创建了一个新的变量）</li></ul> <h3 id="常量"><a href="#常量" class="header-anchor">#</a> 常量</h3> <blockquote><p>常量与变量的区别</p></blockquote> <ul><li>不允许对常量使用 <code>mut</code></li> <li>声明常量使用 <code>const</code> 关键字</li> <li>必须注明值的类型</li> <li>只能被设置为常量表达式，而不可以是其他任何只能在 <code>运行时计算出的值</code></li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">const</span> <span class="token constant">THREE_HOUR_IN_SECONDS</span><span class="token punctuation">:</span> <span class="token keyword">u32</span> <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>🔐 Rust 对常量的命名约定是在单词之间使用全<code>大写加下划线</code></p> <h3 id="数据类型"><a href="#数据类型" class="header-anchor">#</a> 数据类型</h3> <p><code>rust</code> 是 <strong>静态类型</strong> 语言，在编译时就需要知道所有变量的类型</p> <h4 id="标量"><a href="#标量" class="header-anchor">#</a> 标量</h4> <p><code>标量类型</code>代表一个单独的值，Rust 有四种基本的标量类型：整型、浮点型、布尔类型和字符类型</p> <h5 id="整型"><a href="#整型" class="header-anchor">#</a> 整型</h5> <blockquote><p>一个没有小数部分的数字</p></blockquote> <p>🔐 表格：rust 中的整型类型</p> <table><thead><tr><th>长度</th> <th>有符号</th> <th>无符号</th></tr></thead> <tbody><tr><td>8-bit</td> <td><code>i8</code></td> <td><code>u8</code></td></tr> <tr><td>16-bit</td> <td><code>i16</code></td> <td><code>u16</code></td></tr> <tr><td>32-bit</td> <td><code>i32</code></td> <td><code>u32</code></td></tr> <tr><td>64-bit</td> <td><code>i64</code></td> <td><code>u64</code></td></tr> <tr><td>128-bit</td> <td><code>i128</code></td> <td><code>u128</code></td></tr> <tr><td>arch</td> <td><code>isize</code></td> <td><code>usize</code></td></tr></tbody></table> <p>对应 <code>bit位</code> 的变体都可以设置为有符号和无符号。</p> <ul><li>对于 <code>有符号</code>变体来说，存储范围</li></ul> <p>$$
-(2^{n-1}) 到 2^{n - 1} - 1
$$</p> <ul><li>对于 <code>无符号</code> 变体来说，存储范围</li></ul> <p>$$
0 到 2^{n} - 1
$$</p> <ul><li><code>isize</code> &amp; <code>usize</code> 类型依赖运行程序的计算架构：64 位 架构上时 64 位，32 位架构上为 32 位</li> <li>rust 数字类型默认是 <code>i32</code></li></ul> <p>🔐 表格：rust 中的整型字面值</p> <table><thead><tr><th>数字字面值</th> <th>例子</th></tr></thead> <tbody><tr><td>Decimal (十进制)</td> <td><code>98_222</code></td></tr> <tr><td>Hex (十六进制)</td> <td><code>0xff</code></td></tr> <tr><td>Octal (八进制)</td> <td><code>0o77</code></td></tr> <tr><td>Binary (二进制)</td> <td><code>0b1111_0000</code></td></tr> <tr><td>Byte (单字节字符)(仅限于<code>u8</code>)</td> <td><code>b'A'</code></td></tr></tbody></table> <ul><li><code>98_222</code> 等价于 <code>98222</code> ，<code>_</code> 作为分隔符号方便读数</li></ul> <h5 id="浮点型"><a href="#浮点型" class="header-anchor">#</a> 浮点型</h5> <blockquote><p>rust 浮点分为 单精度浮点(<code>f32</code>) 和 双精度浮点 (<code>f64</code>)</p></blockquote> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">2.0</span><span class="token punctuation">;</span> <span class="token comment">// f64(默认)</span>
    <span class="token keyword">let</span> y<span class="token punctuation">:</span> <span class="token keyword">f32</span> <span class="token operator">=</span> <span class="token number">3.0</span><span class="token punctuation">;</span> <span class="token comment">// f32</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="布尔类型"><a href="#布尔类型" class="header-anchor">#</a> 布尔类型</h5> <blockquote><p>rust 布尔类型有两个可能的值 <code>true</code> &amp; <code>false</code></p></blockquote> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> f<span class="token punctuation">:</span><span class="token keyword">bool</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="字符类型"><a href="#字符类型" class="header-anchor">#</a> 字符类型</h5> <blockquote><p>rust 字符类型被定义为 <code>char</code>，代表原生字母类型</p></blockquote> <p>🔐 需要注意的是，使用<code>单引号</code>声明 <code>char</code> 字面量；使用 <code>双引号</code>声明字符串的字面量</p> <h4 id="复合"><a href="#复合" class="header-anchor">#</a> 复合</h4> <p>复合类型将多个值组合成一个类型，包括 <code>tuple</code> 和 <code>array</code></p> <h5 id="元组"><a href="#元组" class="header-anchor">#</a> 元组</h5> <ul><li><p>长度不可变</p></li> <li><p>定义 &amp; 访问</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> tup<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span>
    <span class="token string">&quot;tup.0:{}, tup.1:{}, tup.2:{}, tup.3:{}&quot;</span><span class="token punctuation">,</span>
    tup<span class="token number">.0</span><span class="token punctuation">,</span> tup<span class="token number">.1</span><span class="token punctuation">,</span> tup<span class="token number">.2</span><span class="token punctuation">,</span> tup<span class="token number">.3</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>解构取值</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> tup<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> tup<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h5 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h5> <p>区别于 <code>元组</code>，数组中每个元素类型必须相同；且在 <code>rust</code> 中，数组的长度是固定的</p> <ul><li><p>初始化数组</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> array<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">i32</span><span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 数组长度为5,且所有值类型均为i32</span>
<span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token comment">// 数组长度为5,且所有值均为3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>通过 <code>array[index]</code> 的形式访问值</p></li></ul> <h4 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h4> <p>函数定义与 <code>js</code> 相差不多，同样是 <code>()</code> 包裹参数、<code>{}</code> 包裹函数体，但以下几点需要注意</p> <ul><li><p>函数命名—— 全部采用小写，存在多单词时使用<code>_</code> 分隔</p></li> <li><p>函数参数全部需要注明类型</p></li> <li><p>函数返回基于表达式，表达式不需要在末尾加上 <code>;</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">plus_one</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The value of x is: {x}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">plus_one</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 报错；因为这是一个语句，语句并没有返回值</span>
    x <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment">// 正确；代表这是一个表达式，表达式返回计算值</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h4 id="循环"><a href="#循环" class="header-anchor">#</a> 循环</h4> <blockquote><p><code>rust</code> 中有三种循环：<code>loop</code>、<code>while</code>、<code>for</code>，相对来说比较常用的时后两者</p></blockquote> <h5 id="loop"><a href="#loop" class="header-anchor">#</a> loop</h5> <ul><li><p>可以通过 <code>break</code> 返回循环值</p></li> <li><p>可定义标签，在多层 <code>loop</code> 循环嵌套情景下终止对应标签循环</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">for_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token lifetime-annotation symbol">'counting_up</span><span class="token punctuation">:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> remaining <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
		<span class="token comment">// 嵌套 loop</span>
        <span class="token keyword">loop</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> remaining <span class="token operator">==</span> <span class="token number">9</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">2</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span> <span class="token lifetime-annotation symbol">'counting_up</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            remaining <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul> <h5 id="while"><a href="#while" class="header-anchor">#</a> while</h5> <p>与 <code>js</code> 相差不多</p> <h5 id="for"><a href="#for" class="header-anchor">#</a> for</h5> <p>这里的 <code>for</code> 指的是 <code>for...in</code> 循环，也是使用频率最高且不容易出错的循环</p> <h2 id="所有权"><a href="#所有权" class="header-anchor">#</a> 所有权</h2> <blockquote><p>所有权是 rust 的核心理念，用于 <strong>内存回收</strong></p></blockquote> <p>并不是所有的数据类型都有所有权的概念，像 <code>i32</code> 、<code>boo</code> 这些基本标量以及元组和数组这些复合变量其实都不涉及所有权相关，而 <code>String</code> 这样复杂类型才涉及这个概念。</p> <p>🔐 理解所有权就要理解 <code>rust</code> 变量内存分配模式。</p> <ul><li>对于编译阶段就能确定所需要内存空间的变量来说，主要存储在<code>栈内存</code>中，当变量离开对应的作用域后自动回收（出栈）</li> <li>对于在运行时才能确定内存空间的变量来说，数据存储在 <code>堆内存</code> ，而在 <code>栈内存</code>中则开辟一个空间存储 堆内存的地址、数据长度、容量</li></ul> <p>所有权机制：对于数据存储在 <code>堆内存</code>中的变量，一旦被赋值给了其他变量，则内存所有权转交，当前变量被认为不再有效。</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">;</span> <span class="token comment">// s1 指向的堆内存所有权转交给了 s2，s1不再有效</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>🔐 对于不希望出现上诉所有权转交的情况则需要理解 <code>借用</code> 机制</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">;</span> <span class="token comment">// s2具备访问s1堆内存能力但所有权不转交</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>借用</code> 机制存在风险 —— 借用的作用域为<strong>借用开始到最后一次使用结束</strong>，在该作用域内：</p> <ul><li>可以同时存在不可变的借用</li> <li>不能同时存在可变和不可变的借用</li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">;</span>
<span class="token keyword">let</span> s3 <span class="token operator">=</span> <span class="token keyword">mut</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">;</span>
<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;{s3}&quot;</span><span class="token punctuation">)</span> <span class="token comment">// no error</span>
<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;{}{}&quot;</span><span class="token punctuation">,</span> s2<span class="token punctuation">,</span> s3<span class="token punctuation">)</span> <span class="token comment">// error</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>🔐 <strong>slice</strong> 类型</p> <p><code>slice</code> 类型的引入主要是保证对 String 类型的引用持续有效</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token function">get_first_index</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    s1<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// s1清空了i作为其内部的索引自然也就无效，看上去 get_first_index 的存在毫无意义，但在编译阶段无法检查该无用行为</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>为了解决上面问题，可以在 <code>get_first_index</code> 返回一个对 <code>s1</code> 的引用 <code>&amp;s1[2..]</code> 来代替索引，这样就能保持对 <code>s1</code> 的持久引用，一旦 <code>clear</code> ，就在尝试获取可变的引用，与 i 作为不可变引用可相互牵制</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span> <span class="token comment">// 引用 s1 整个字符串</span>
<span class="token keyword">let</span> s3 <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">// 引用 s1 前两个字符串</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id=""><a href="#" class="header-anchor">#</a></h3> <h2 id="结构体"><a href="#结构体" class="header-anchor">#</a> 结构体</h2> <blockquote><p>结构体与 C 里面的概念相似，可以被理解为是某类属性的集合</p></blockquote> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">User</span> <span class="token punctuation">{</span>
    active<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    sign_in_count<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span>


<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        active<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;jzyismylover&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;3011543110@qq.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>🔐 以上定义的是不可变结构体，变量是否可变取决于结构体本身；结构体同样存在所有权的概念，因此往往在使用的时候都会以借用方式使用</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">get_username</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">:</span> <span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function">get_username</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>🔐 结构体可定义内部方法，通常我们叫他关联函数；方法的第一个参数一般是 <code>&amp;self:Self</code> 简写为 <code>&amp;Self</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">area</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span> <span class="token comment">// 关联函数</span>
      <span class="token keyword">return</span> <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>🔐 关联函数可以不是方法，可用作返回一个结构体新实例的构造函数</p> <p><code>let sq = Rectangle::square(3);</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">square</span><span class="token punctuation">(</span>size<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> size<span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> size<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>🔐 结构体元组</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Color</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rgb <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token class-name">Color</span><span class="token punctuation">(</span>red<span class="token punctuation">,</span> blue<span class="token punctuation">,</span> green<span class="token punctuation">)</span> <span class="token operator">=</span> rgb<span class="token punctuation">;</span> <span class="token comment">// 允许解构</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="枚举"><a href="#枚举" class="header-anchor">#</a> 枚举</h2> <blockquote><p>相比于结构体，枚举提供了集合聚集功能，也就是允许我们定义一个集合里面的若干类别</p></blockquote> <ul><li><p>定义 <code>枚举</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">enum</span> <span class="token type-definition class-name">Message</span> <span class="token punctuation">{</span>
    <span class="token class-name">Quit</span><span class="token punctuation">,</span>
    <span class="token class-name">Move</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token class-name">Write</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">ChangeColor</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// 使用的时候需要 Message::Quit 指定成员</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p><code>Options</code> 枚举</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// 区别于普通枚举，Option 枚举挂载在全局作用域</span>
<span class="token comment">// 使用到了泛型概念</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">None</span><span class="token punctuation">,</span>
    <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 使用的时候直接使用类型即可 Some(5)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>类型判定：枚举中对应的是同一类别不同的实体，因此往往需要去进行对应实体类型判定，常用可以使用 <code>match</code> 或者 <code>if let</code> 去界定类型</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">value_in_cents</span><span class="token punctuation">(</span>coin<span class="token punctuation">:</span> <span class="token class-name">Coin</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u8</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> coin <span class="token punctuation">{</span>
        <span class="token class-name">Coin</span><span class="token punctuation">::</span><span class="token class-name">Penny</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token class-name">Coin</span><span class="token punctuation">::</span><span class="token class-name">Quarter</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// state 指代泛型值</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul> <h2 id="模块"><a href="#模块" class="header-anchor">#</a> 模块</h2> <blockquote><p>模块在 rust 里面是一个比较重要的概念，规定了我们如何去导包以及组织项目结构</p></blockquote> <div class="language-text line-numbers-mode"><pre class="language-text"><code>src
├─front_of_house.rs
├─lib.rs
├─main.rs
├─bin
|  ├─enum.rs
|  ├─loop.rs
|  ├─ownership.rs
|  ├─struct.rs
|  └variable.rs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>rust</code> 中其实模块指代的就是一个包(crate)，<code>crate</code> 其实有两种，一种是 <code>binary crate</code>，一种是 <code>package crate</code>。</p> <ul><li><code>binary crate</code>：包含 <code>main</code> 函数，可执行</li> <li><code>package crate</code>：不包含 <code>main</code> 函数，通常是一个集合方法的定义暴露给其他模块使用</li></ul> <p>🔐 定义 <code>package crate</code></p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token comment">// src/lib.rs</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">front_of_house</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">user</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>以上几乎所有的模块都定义在 <code>crate</code> 根目录，即 <code>src/lib.rs</code>，代码过于冗余，因此需要将模块内部的代码进行拆分。因此才会出现上面展示的项目目录，即在 <code>src</code> 内部定义 <code>front_of_house.rs</code> 文件</p> <ul><li>私有 &amp; 公有</li></ul> <p>默认情况下一个模块内定义的方法、枚举、结构体都是私有的，如果需要能够暴露给外部使用的话需要加上 <code>pub</code> 字段</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">mod</span> <span class="token module-declaration namespace">fronted</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">mod</span> <span class="token module-declaration namespace">fronted</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">practise</span> <span class="token punctuation">{</span>
        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">mod</span> <span class="token module-declaration namespace">hosting</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Mode</span> <span class="token punctuation">{</span>
        <span class="token keyword">pub</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
        <span class="token keyword">pub</span> age<span class="token punctuation">:</span> <span class="token keyword">i32</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// no error</span>
<span class="token keyword">let</span> <span class="token keyword">mut</span> user <span class="token operator">=</span> <span class="token namespace">hosting<span class="token punctuation">::</span></span><span class="token class-name">Mode</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>🔐 定义 <code>binary crate</code></p> <p>一般 <code>binary crate</code> 定义在 <code>bin</code> 目录下，使用 <code>cargo</code> 执行的时候</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cargo</span> run <span class="token parameter variable">--bin</span> <span class="token punctuation">[</span>binary package name<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="vetur"><a href="#vetur" class="header-anchor">#</a> vetur</h2> <blockquote><p>vetur 允许在单独的数据结构中存储多个相同类型的值</p></blockquote> <ul><li>初始化</li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> v<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Vetur</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 初始化未知数据类型</span>
<span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">// 初始值已知情况下</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>更新 <code>vetur</code></li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code>v<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>读取 <code>vetur</code></li></ul> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token operator">&amp;</span>v<span class="token punctuation">[</span>index<span class="token punctuation">]</span>

v<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>两种方式的区别：</p> <ul><li>通过借用方式访问索引的方式一旦遇到 <code>index</code> 越界会抛错给编译器；返回值以一个对该索引对应数值的引用</li> <li>通过 <code>get</code> 方式访问在遇到上诉情况会返回 None；返回值是一个可以用于 <code>match</code> 的 <code>Option&lt;T&gt;</code>，因此可通过 <code>match</code> 对越界情况作出相应的用户提示</li></ul> <h2 id="泛型"><a href="#泛型" class="header-anchor">#</a> 泛型</h2> <blockquote><p>与 TS 类似，泛型使得代码整体可复用性更好，兼容更多的类型</p></blockquote> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token class-name">Point</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">x</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token class-name">T</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>x
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> integer <span class="token operator">=</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> float <span class="token operator">=</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">4.0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>比较有意思的点是一个类型专用，以下实例化泛型，如果 <code>Point</code> 结构体成员的类型均为 <code>f32</code> 才具备 <code>distance_from_origin</code> 方法</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">Point</span><span class="token operator">&lt;</span><span class="token keyword">f32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">distance_from_origin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">f32</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>x<span class="token punctuation">.</span><span class="token function">powi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y<span class="token punctuation">.</span><span class="token function">powi</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>🔐 泛型性能</p> <p>得益于 <code>rust</code> 在编译时对泛型代的单态化，因此实际不会对运行时效率产生影响。单态化是一个通过填充编译时使用的具体类型，将通用代码转换为特定代码的过程。</p> <div class="language-rust line-numbers-mode"><pre class="language-rust"><code><span class="token keyword">let</span> integer <span class="token operator">=</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> float <span class="token operator">=</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 单态化后</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">Option_i32</span> <span class="token punctuation">{</span>
    <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">None</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">Option_f64</span> <span class="token punctuation">{</span>
    <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">None</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> integer <span class="token operator">=</span> <span class="token class-name">Option_i32</span><span class="token punctuation">::</span><span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> float <span class="token operator">=</span> <span class="token class-name">Option_f64</span><span class="token punctuation">::</span><span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></div> <footer class="page-edit page-editor"><div class="edit-link"><a href="https://github.com/jzyismylover/ubuntu-markdown/edit/docs/backend/rust/rust.md" target="_blank" rel="noopener noreferrer">完善页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">3/17/2024, 9:24:20 AM</span></div></footer> <!----></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">rust</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/markdown/rust/#安装" class="toc-sidebar-link">安装</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#编译过程" class="toc-sidebar-link">编译过程</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#常见编程概念" class="toc-sidebar-link">常见编程概念</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/markdown/rust/#变量" class="toc-sidebar-link">变量</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/rust/#常量" class="toc-sidebar-link">常量</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/rust/#数据类型" class="toc-sidebar-link">数据类型</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/rust/#标量" class="toc-sidebar-link">标量</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#整型" class="toc-sidebar-link">整型</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#浮点型" class="toc-sidebar-link">浮点型</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#布尔类型" class="toc-sidebar-link">布尔类型</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#字符类型" class="toc-sidebar-link">字符类型</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/rust/#复合" class="toc-sidebar-link">复合</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#元组" class="toc-sidebar-link">元组</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#数组" class="toc-sidebar-link">数组</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/rust/#函数" class="toc-sidebar-link">函数</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/rust/#循环" class="toc-sidebar-link">循环</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#loop" class="toc-sidebar-link">loop</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#while" class="toc-sidebar-link">while</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-5"><a href="/markdown/rust/#for" class="toc-sidebar-link">for</a></li></ul></li><li><a href="/markdown/rust/#所有权" class="toc-sidebar-link">所有权</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/markdown/rust/#" class="toc-sidebar-link"></a></li></ul></li><li><a href="/markdown/rust/#结构体" class="toc-sidebar-link">结构体</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#枚举" class="toc-sidebar-link">枚举</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#模块" class="toc-sidebar-link">模块</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#vetur" class="toc-sidebar-link">vetur</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/rust/#泛型" class="toc-sidebar-link">泛型</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div>  <div></div></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><!----></div></div>
    <script src="/markdown/assets/js/app.085aa012.js" defer></script><script src="/markdown/assets/js/2.773263cd.js" defer></script><script src="/markdown/assets/js/41.afe775e0.js" defer></script>
  </body>
</html>
