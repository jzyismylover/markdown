<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å‰ç«¯é”™è¯¯æ•è· | Mr.Jiang-æŠ€æœ¯åšå®¢</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="">
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?2675818a983a3131404cee835018f016";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script>
    <meta name="description" content="å­¦ä¹ &amp;å·¥ä½œ-æŠ€æœ¯ç§¯ç´¯">
    
    <link rel="preload" href="/markdown/assets/css/0.styles.5474aed4.css" as="style"><link rel="preload" href="/markdown/assets/js/app.085aa012.js" as="script"><link rel="preload" href="/markdown/assets/js/2.773263cd.js" as="script"><link rel="preload" href="/markdown/assets/js/42.19b2951c.js" as="script"><link rel="prefetch" href="/markdown/assets/js/1.50bc9635.js"><link rel="prefetch" href="/markdown/assets/js/10.121e7e8f.js"><link rel="prefetch" href="/markdown/assets/js/11.5205ffab.js"><link rel="prefetch" href="/markdown/assets/js/12.fef29d74.js"><link rel="prefetch" href="/markdown/assets/js/13.b581db50.js"><link rel="prefetch" href="/markdown/assets/js/14.07202c28.js"><link rel="prefetch" href="/markdown/assets/js/15.9aedb95a.js"><link rel="prefetch" href="/markdown/assets/js/16.dd97e264.js"><link rel="prefetch" href="/markdown/assets/js/17.8eb943fb.js"><link rel="prefetch" href="/markdown/assets/js/18.942cde78.js"><link rel="prefetch" href="/markdown/assets/js/19.44710683.js"><link rel="prefetch" href="/markdown/assets/js/20.22d46747.js"><link rel="prefetch" href="/markdown/assets/js/21.aa8b4011.js"><link rel="prefetch" href="/markdown/assets/js/22.b40024cc.js"><link rel="prefetch" href="/markdown/assets/js/23.ace5d346.js"><link rel="prefetch" href="/markdown/assets/js/24.2405d60a.js"><link rel="prefetch" href="/markdown/assets/js/25.c08a85e2.js"><link rel="prefetch" href="/markdown/assets/js/26.c4c5f267.js"><link rel="prefetch" href="/markdown/assets/js/27.b91e5849.js"><link rel="prefetch" href="/markdown/assets/js/28.b80c3633.js"><link rel="prefetch" href="/markdown/assets/js/29.594ec447.js"><link rel="prefetch" href="/markdown/assets/js/3.9d4223ad.js"><link rel="prefetch" href="/markdown/assets/js/30.324e278d.js"><link rel="prefetch" href="/markdown/assets/js/31.43dc2191.js"><link rel="prefetch" href="/markdown/assets/js/32.3fb01abd.js"><link rel="prefetch" href="/markdown/assets/js/33.5a2693b9.js"><link rel="prefetch" href="/markdown/assets/js/34.637d4661.js"><link rel="prefetch" href="/markdown/assets/js/35.eccfebaa.js"><link rel="prefetch" href="/markdown/assets/js/36.c13df5f5.js"><link rel="prefetch" href="/markdown/assets/js/37.9890e89c.js"><link rel="prefetch" href="/markdown/assets/js/38.b33827f2.js"><link rel="prefetch" href="/markdown/assets/js/39.3a1ace37.js"><link rel="prefetch" href="/markdown/assets/js/4.27d6f5b1.js"><link rel="prefetch" href="/markdown/assets/js/40.4396d4c2.js"><link rel="prefetch" href="/markdown/assets/js/41.afe775e0.js"><link rel="prefetch" href="/markdown/assets/js/43.7c3256ea.js"><link rel="prefetch" href="/markdown/assets/js/44.7da308e4.js"><link rel="prefetch" href="/markdown/assets/js/45.89b2fd21.js"><link rel="prefetch" href="/markdown/assets/js/46.e817e45d.js"><link rel="prefetch" href="/markdown/assets/js/47.c56ee626.js"><link rel="prefetch" href="/markdown/assets/js/48.59541039.js"><link rel="prefetch" href="/markdown/assets/js/49.bc7ad96a.js"><link rel="prefetch" href="/markdown/assets/js/5.2637f2cc.js"><link rel="prefetch" href="/markdown/assets/js/50.9d0dc446.js"><link rel="prefetch" href="/markdown/assets/js/51.4d949834.js"><link rel="prefetch" href="/markdown/assets/js/52.90aa4f80.js"><link rel="prefetch" href="/markdown/assets/js/53.67b77129.js"><link rel="prefetch" href="/markdown/assets/js/54.3535db37.js"><link rel="prefetch" href="/markdown/assets/js/55.9efbe9e5.js"><link rel="prefetch" href="/markdown/assets/js/56.e8aa37ba.js"><link rel="prefetch" href="/markdown/assets/js/57.af66ff8f.js"><link rel="prefetch" href="/markdown/assets/js/58.0415674f.js"><link rel="prefetch" href="/markdown/assets/js/59.b09373ca.js"><link rel="prefetch" href="/markdown/assets/js/6.61bacfb8.js"><link rel="prefetch" href="/markdown/assets/js/60.d07cb515.js"><link rel="prefetch" href="/markdown/assets/js/61.ec2b2da7.js"><link rel="prefetch" href="/markdown/assets/js/62.44a5a0b8.js"><link rel="prefetch" href="/markdown/assets/js/63.09e39adc.js"><link rel="prefetch" href="/markdown/assets/js/64.b9ee085d.js"><link rel="prefetch" href="/markdown/assets/js/65.026450b0.js"><link rel="prefetch" href="/markdown/assets/js/66.a3571972.js"><link rel="prefetch" href="/markdown/assets/js/67.5a8616c4.js"><link rel="prefetch" href="/markdown/assets/js/68.6fdda787.js"><link rel="prefetch" href="/markdown/assets/js/69.691ff5d7.js"><link rel="prefetch" href="/markdown/assets/js/7.32a4bd87.js"><link rel="prefetch" href="/markdown/assets/js/70.b401009e.js"><link rel="prefetch" href="/markdown/assets/js/71.6b3bcefe.js"><link rel="prefetch" href="/markdown/assets/js/72.dcd8145e.js"><link rel="prefetch" href="/markdown/assets/js/73.cc81c046.js"><link rel="prefetch" href="/markdown/assets/js/74.856f40f0.js"><link rel="prefetch" href="/markdown/assets/js/75.746590de.js"><link rel="prefetch" href="/markdown/assets/js/76.8ddba5b5.js"><link rel="prefetch" href="/markdown/assets/js/77.16644476.js"><link rel="prefetch" href="/markdown/assets/js/78.e89fc885.js"><link rel="prefetch" href="/markdown/assets/js/79.1193b665.js"><link rel="prefetch" href="/markdown/assets/js/80.9475cd89.js"><link rel="prefetch" href="/markdown/assets/js/81.8d99d275.js"><link rel="prefetch" href="/markdown/assets/js/82.80eb3e2f.js"><link rel="prefetch" href="/markdown/assets/js/83.fe14141e.js"><link rel="prefetch" href="/markdown/assets/js/84.9647a2db.js"><link rel="prefetch" href="/markdown/assets/js/85.c7258f01.js"><link rel="prefetch" href="/markdown/assets/js/86.1a5782f4.js"><link rel="prefetch" href="/markdown/assets/js/87.e7354607.js"><link rel="prefetch" href="/markdown/assets/js/vendors~docsearch.54f2532f.js">
    <link rel="stylesheet" href="/markdown/assets/css/0.styles.5474aed4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/markdown/" class="home-link router-link-active"><img src="/markdown/logo.png" alt="Mr.Jiang-æŠ€æœ¯åšå®¢" class="logo"> <span class="site-name can-hide">Mr.Jiang-æŠ€æœ¯åšå®¢</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/jzyismylover/ubuntu-markdown" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/jzyismylover/ubuntu-markdown" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/markdown/fronted/" class="sidebar-link">å‰ç«¯çŸ¥è¯†æ¦‚è¿°</a></li><li><a href="/markdown/git/" class="sidebar-link">ç‰ˆæœ¬æ§åˆ¶</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/markdown/typescript/" class="sidebar-link">Typescript</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Electron</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>å‰ç«¯ç›‘æ§</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/markdown/capture/" aria-current="page" class="active sidebar-link">å‰ç«¯é”™è¯¯æ•è·</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown/capture/#è¿è¡Œæ—¶é”™è¯¯" class="sidebar-link">è¿è¡Œæ—¶é”™è¯¯</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#é™æ€èµ„æºé”™è¯¯" class="sidebar-link">é™æ€èµ„æºé”™è¯¯</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#promise-é”™è¯¯" class="sidebar-link">Promise é”™è¯¯</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#http-é”™è¯¯" class="sidebar-link">HTTP é”™è¯¯</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#è·¨åŸŸè„šæœ¬é”™è¯¯" class="sidebar-link">è·¨åŸŸè„šæœ¬é”™è¯¯</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#æ¡†æ¶å†…é”™è¯¯" class="sidebar-link">æ¡†æ¶å†…é”™è¯¯</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#beacon" class="sidebar-link">beacon</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#image" class="sidebar-link">image</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#request" class="sidebar-link">request</a></li><li class="sidebar-sub-header"><a href="/markdown/capture/#æ˜ å°„è¿‡ç¨‹" class="sidebar-link">æ˜ å°„è¿‡ç¨‹</a></li></ul></li><li><a href="/markdown/performance/" class="sidebar-link">æ€§èƒ½ä¼˜åŒ–</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="content"><div class="content-wrapper" style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="å‰ç«¯é”™è¯¯æ•è·"><a href="#å‰ç«¯é”™è¯¯æ•è·" class="header-anchor">#</a> å‰ç«¯é”™è¯¯æ•è·</h1> <p>å‰ç«¯é”™è¯¯ç›‘æ§æµç¨‹ï¼š</p> <ol><li>æ•è·é”™è¯¯æ„é€ éœ€è¦å‘ˆç°åœ¨æŠ¥è¡¨æ±‡æ€»ä¸­çš„ä¿¡æ¯</li> <li>ä¸ŠæŠ¥æ„é€ å¥½çš„é”™è¯¯ä¿¡æ¯</li> <li>æ ¹æ®é”™è¯¯ä¿¡æ¯ç»“æ„ç»˜åˆ¶æŠ¥è¡¨ UIï¼Œåœ¨ UI ä¸­è¿›è¡Œé”™è¯¯å®šä½</li></ol> <p>ä»¥ä¸‹ä¼šå¯¹ä¸Šè¿°ä¸‰ä¸ªæµç¨‹è¿›è¡Œåˆ†æ</p> <blockquote><p><a href="https://juejin.cn/post/7100841779854835719#heading-5" target="_blank" rel="noopener noreferrer">å‰ç«¯é”™è¯¯æ•è·<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ol><li>ä¸ºä»€ä¹ˆè¦æ•è·é”™è¯¯ç„¶åè¿›è¡Œä¸ŠæŠ¥ï¼Ÿ</li> <li>ä»å‰ç«¯çš„è§’åº¦æ¥è¯´æ•è·ä»€ä¹ˆå†…å®¹ï¼Ÿ</li> <li>å¦‚ä½•é€šè¿‡ api è¿›è¡Œå‰ç«¯é”™è¯¯æ•è·ï¼Ÿ</li></ol> <ul><li><p>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼ˆä¸ºä»€ä¹ˆéœ€è¦æ•è· &amp; ä¸ŠæŠ¥é”™è¯¯ï¼‰ï¼šé”™è¯¯æ˜¯ç”¨æˆ·ä½¿ç”¨ç³»ç»ŸåŠŸèƒ½å¼‚å¸¸çš„åé¦ˆï¼Œåœ¨å‡ºç°é—®é¢˜çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡é”™è¯¯å¿«é€Ÿå®šä½é—®é¢˜ä½ç½®</p></li> <li><p>ç¬¬äºŒä¸ªé—®é¢˜ï¼ˆéœ€è¦æ•è·ä»€ä¹ˆé”™è¯¯ï¼‰ï¼šä»å®è§‚æ¥åˆ†å¯ä»¥åˆ†ä¸º js æŠ¥é”™ å’Œ http æŠ¥é”™.</p> <ul><li>js æŠ¥é”™æŒ‡çš„æ˜¯è¿è¡Œæ—¶ä¸Šä»£ç æ®µçš„æ‰§è¡Œé”™è¯¯</li> <li>http æŠ¥é”™æŒ‡çš„æ˜¯ç½‘ç»œè¯·æ±‚çš„æŠ¥é”™ï¼ˆç½‘ç«™æ•°æ®çš„å±•ç¤ºä¾èµ–äºç½‘ç»œå“åº”è¯·æ±‚è¿”å›ï¼‰</li></ul></li> <li><p>ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼ˆæ€ä¹ˆæ•è·é”™è¯¯ï¼‰</p> <ul><li>window.onerror</li> <li>window.addEventListener('error')</li> <li>app.prototype.errorHandler</li> <li>window.addEventListener('unhandlerejection')</li></ul></li></ul> <blockquote><p>ä»å¾®è§‚æ¥åˆ†ç±»é”™è¯¯çš„ç±»å‹</p></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">enum</span> mechanismType <span class="token punctuation">{</span>
  <span class="token constant">JS</span> <span class="token operator">=</span> <span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">RS</span> <span class="token operator">=</span> <span class="token string">&quot;resource&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">UJ</span> <span class="token operator">=</span> <span class="token string">&quot;unhandledrejection&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">HP</span> <span class="token operator">=</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">CS</span> <span class="token operator">=</span> <span class="token string">&quot;cors&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">VUE</span> <span class="token operator">=</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="è¿è¡Œæ—¶é”™è¯¯"><a href="#è¿è¡Œæ—¶é”™è¯¯" class="header-anchor">#</a> è¿è¡Œæ—¶é”™è¯¯</h2> <blockquote><p>è¿è¡Œæ—¶ <code>JS</code> é”™è¯¯æ•è·æ–¹æ³•ï¼š<code>window.onerror</code>ã€<code>window.addEvenetListener('error')</code></p></blockquote> <p>ä¸¤è€…çš„åŒºåˆ«ï¼š</p> <ol><li><code>window.onerror</code> åªèƒ½å­˜åœ¨ä¸€ä¸ªä¸”åå£°æ˜çš„è¦†ç›–å‰é¢å£°æ˜çš„ï¼Œ<code>window.addEvenetListener('error')</code> å¯ä»¥å£°æ˜å¤šä¸ªï¼ŒæŒ‰æ·»åŠ é¡ºåºè§¦å‘æ‰§è¡Œ</li> <li><code>window.addEvenetListener('error')</code> èƒ½å¤Ÿå¤„ç†é™æ€èµ„æºé”™è¯¯</li> <li><code>window.addEventListener('error')</code> åœ¨æ•è·é˜¶æ®µå·¥ä½œ</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> source<span class="token punctuation">,</span> lineno<span class="token punctuation">,</span> colno<span class="token punctuation">,</span> error</span><span class="token punctuation">)</span>
<span class="token comment">// @return boolean</span>
<span class="token comment">// true: prevent console</span>
<span class="token comment">// false: console in the browser</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>message(<code>String</code>)ï¼šé”™è¯¯ä¿¡æ¯</li> <li>source(<code>String</code>)ï¼šå‘ç”Ÿé”™è¯¯çš„è„šæœ¬ url</li> <li>lineno(<code>Number</code>)ï¼šå‘é€é”™è¯¯çš„è¡Œå·</li> <li>colno(<code>Number</code>)ï¼šå‘ç”Ÿé”™è¯¯çš„åˆ—å·</li> <li>error(<code>Error</code>)ï¼šError å¯¹è±¡</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>error( <code>ErrorEvent</code>)ï¼šé”™è¯¯äº‹ä»¶å¯¹è±¡ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ErrorEvent" target="_blank" rel="noopener noreferrer">MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>extend Event</li> <li>message(<code>String</code>)ï¼šé”™è¯¯ä¿¡æ¯</li> <li>filename(<code>String</code>)ï¼šå‘ç”Ÿé”™è¯¯çš„è„šæœ¬ url</li> <li>lineno(<code>Number</code>)ï¼šå‘é€é”™è¯¯çš„è¡Œå·</li> <li>colno(<code>Number</code>)ï¼šå‘ç”Ÿé”™è¯¯çš„åˆ—å·</li> <li>error(<code>Error</code>)ï¼šError å¯¹è±¡</li></ul></li></ul> <blockquote><p>js è¿è¡Œæ—¶é”™è¯¯ç±»å‹</p></blockquote> <img src="/markdown/assets/img/image-20231108004503666.7a94894a.png" style="display:block;margin:auto;"> <p>ğŸ² è§£æè¿è¡Œæ—¶é”™è¯¯å †æ ˆè°ƒç”¨ï¼šå¯ä»¥ä½¿ç”¨å¼€æºåº“ <a href="https://www.npmjs.com/package/error-stack-parser/v/2.0.5" target="_blank" rel="noopener noreferrer"><code>error-stack-parser</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, ä¼ å…¥ <code>error</code> å¯¹è±¡å¯ä»¥å¸®åŠ©è§£æå‡ºè°ƒç”¨å †æ ˆä»¥åŠå…·ä½“é”™è¯¯å‘ç”Ÿçš„è¡Œå·ã€åˆ—å·â€¦â€¦.ã€‚ï¼ˆè™½ç„¶æ²¡å…·ä½“æ·±å…¥äº†è§£æºç ï¼Œä½†æ˜¯åŸºæœ¬çš„å®ç°åº”è¯¥å¦‚ä¸‹ï¼ŒåŸºäºæ­£åˆ™å¤„ç† <code>error message string</code>ï¼‰</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨ä»¥è§£æå †æ ˆsplitåå¾—åˆ°çš„å­—ç¬¦ä¸²</span>
<span class="token keyword">const</span> <span class="token constant">FULL_MATCH</span> <span class="token operator">=</span>
  <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|&lt;anonymous&gt;|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">;</span>

<span class="token comment">// é™åˆ¶åªè¿½æº¯10ä¸ªå †æ ˆ</span>
<span class="token keyword">const</span> <span class="token constant">STACKTRACE_LIMIT</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">// è§£ææ¯ä¸€è¡Œ</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">parseStackLine</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">line</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> lineMatch <span class="token operator">=</span> line<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token constant">FULL_MATCH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>lineMatch<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> filename <span class="token operator">=</span> lineMatch<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> functionName <span class="token operator">=</span> lineMatch<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> lineno <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>lineMatch<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> colno <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>lineMatch<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">,</span>
    functionName<span class="token punctuation">,</span>
    lineno<span class="token punctuation">,</span>
    colno<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="é™æ€èµ„æºé”™è¯¯"><a href="#é™æ€èµ„æºé”™è¯¯" class="header-anchor">#</a> é™æ€èµ„æºé”™è¯¯</h2> <p>é™æ€èµ„æºåŠ è½½å¼‚å¸¸ï¼šç•Œé¢ä¸Šçš„ <code>img å›¾ç‰‡</code>ã€<code>CDN èµ„æº</code> <strong>çªç„¶å¤±æ•ˆäº†ã€æ‰“ä¸å¼€äº†</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä½¿ç”¨ <code>addEventListener</code> æ•è·èµ„æºé”™è¯¯æ—¶ï¼Œä¸€å®šè¦å°† <strong>ç¬¬ä¸‰ä¸ªé€‰é¡¹è®¾ä¸º true</strong>ï¼Œå› ä¸ºèµ„æºé”™è¯¯æ²¡æœ‰å†’æ³¡ï¼Œæ‰€ä»¥åªèƒ½åœ¨æ•è·é˜¶æ®µæ•è·ã€‚åŒç†ï¼Œç”±äº <code>window.onerror</code> æ˜¯é€šè¿‡åœ¨å†’æ³¡é˜¶æ®µæ•è·é”™è¯¯ï¼Œæ‰€ä»¥æ— æ³•æ•è·èµ„æºé”™è¯¯ã€‚</p> <h2 id="promise-é”™è¯¯"><a href="#promise-é”™è¯¯" class="header-anchor">#</a> Promise é”™è¯¯</h2> <p><code>Promise</code>å¼‚å¸¸ï¼š <code>Promise</code> è¢« <code>reject</code> ä¸”æ²¡æœ‰è¢« <code>catch</code> å¤„ç†çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º <code>Promiseå¼‚å¸¸</code> ï¼ˆåŒ…æ‹¬ <code>Promise</code> å†…çš„ <code>JS</code> é”™è¯¯ï¼‰</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;unhandledrejection&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handler</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ³¨æ„ï¼š<code>promise</code> æŠ¥é”™åªèƒ½è·å¾—å…·ä½“æŠ¥é”™ä¿¡æ¯ï¼Œè·å–ä¸åˆ°å…·ä½“æŠ¥é”™è¡Œå·ã€åˆ—å·</p> <h2 id="http-é”™è¯¯"><a href="#http-é”™è¯¯" class="header-anchor">#</a> HTTP é”™è¯¯</h2> <p><code>HTTP</code> å¼‚å¸¸ï¼šé€šå¸¸å¯ä»¥ç†è§£ä¸ºæ˜¯é’ˆå¯¹ä¸šåŠ¡æ¥å£è¯·æ±‚å¼‚å¸¸ï¼ˆ400ã€500ï¼‰æˆ–è€…æ˜¯ä¸šåŠ¡æ¥å£æŠ›å‡ºçš„ä¸šåŠ¡é”™è¯¯ã€‚</p> <p>ä»æ•è·è§’åº¦æ¥è¯´ï¼Œå› ä¸º <code>HTTP</code> è¯·æ±‚åœ°å±‚é€»è¾‘æ˜¯åŸºäº <code>XMLHttpRequest</code> | <code>fetch</code> å®Œæˆï¼Œå› æ­¤å¯ä»¥é‡å†™æ–¹æ³•æ¥åŒ…å«é”™è¯¯æ•è·é€»è¾‘</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/* XMLHttpRequest æ•è·æŒ‡æ ‡ */</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">httpMetrics</span> <span class="token punctuation">{</span>
  method<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  url<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token constant">URL</span><span class="token punctuation">;</span>
  body<span class="token operator">:</span> Document <span class="token operator">|</span> XMLHttpRequestBodyInit <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">|</span> ReadableStream<span class="token punctuation">;</span>
  requestTime<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  responseTime<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  status<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  statusText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  response<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>é‡å†™ <code>XMLHttpRequest</code></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">proxyXmlHttp</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  sendHandler<span class="token operator">:</span> <span class="token builtin">Function</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  loadHandler<span class="token operator">:</span> <span class="token builtin">Function</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;XMLHttpRequest&quot;</span> <span class="token keyword">in</span> window <span class="token operator">&amp;&amp;</span>
    <span class="token keyword">typeof</span> window<span class="token punctuation">.</span>XMLHttpRequest <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> oXMLHttpRequest <span class="token operator">=</span> window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>window <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>oXMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// oXMLHttpRequest ä¸ºåŸç”Ÿçš„ XMLHttpRequestï¼Œå¯ä»¥ç”¨ä»¥ SDK è¿›è¡Œæ•°æ®ä¸ŠæŠ¥ï¼ŒåŒºåˆ†ä¸šåŠ¡</span>
      <span class="token punctuation">(</span>window <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>oXMLHttpRequest <span class="token operator">=</span> oXMLHttpRequest<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">(</span>window <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">XMLHttpRequest</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">oXMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> open<span class="token punctuation">,</span> send <span class="token punctuation">}</span> <span class="token operator">=</span> xhr<span class="token punctuation">;</span>
      <span class="token keyword">let</span> metrics <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> httpMetrics<span class="token punctuation">;</span>

      xhr<span class="token punctuation">.</span><span class="token function-variable function">open</span> <span class="token operator">=</span> <span class="token punctuation">(</span>method<span class="token punctuation">,</span> url<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        metrics<span class="token punctuation">.</span>method <span class="token operator">=</span> method<span class="token punctuation">;</span>
        metrics<span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
        <span class="token function">open</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>xhr<span class="token punctuation">,</span> method<span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      xhr<span class="token punctuation">.</span><span class="token function-variable function">send</span> <span class="token operator">=</span> <span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        metrics<span class="token punctuation">.</span>body <span class="token operator">=</span> body <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        metrics<span class="token punctuation">.</span>requestTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// sendHandler å¯ä»¥åœ¨å‘é€ Ajax è¯·æ±‚ä¹‹å‰ï¼ŒæŒ‚è½½ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚ header è¯·æ±‚å¤´</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> sendHandler <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token function">sendHandler</span><span class="token punctuation">(</span>xhr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">send</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>xhr<span class="token punctuation">,</span> body<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      xhr<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;loadend&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> status<span class="token punctuation">,</span> statusText<span class="token punctuation">,</span> response <span class="token punctuation">}</span> <span class="token operator">=</span> xhr<span class="token punctuation">;</span>
        metrics <span class="token operator">=</span> <span class="token punctuation">{</span>
          <span class="token operator">...</span>metrics<span class="token punctuation">,</span>
          status<span class="token punctuation">,</span>
          statusText<span class="token punctuation">,</span>
          response<span class="token punctuation">,</span>
          responseTime<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> loadHandler <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token function">loadHandler</span><span class="token punctuation">(</span>metrics<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// xhr.status çŠ¶æ€ç </span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> xhr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="è·¨åŸŸè„šæœ¬é”™è¯¯"><a href="#è·¨åŸŸè„šæœ¬é”™è¯¯" class="header-anchor">#</a> è·¨åŸŸè„šæœ¬é”™è¯¯</h2> <p>è·¨åŸŸè„šæœ¬é”™è¯¯ï¼šå­˜åœ¨è·¨åŸŸå¼•ç”¨èµ„æºçš„æƒ…å†µ</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">handler</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>é€šè¿‡ä»¥ä¸Šä»£ç å¯ä»¥æ•è·è¿™ç§ç±»å‹é”™è¯¯ï¼Œä½†æ˜¯è¿”å›çš„æ°¸è¿œæ˜¯ <code>Script error</code>ï¼Œä¹Ÿæ²¡æœ‰è·å–åˆ°<code>è¡Œå·</code>ã€<code>åˆ—å·</code>ã€<code>æ–‡ä»¶å</code>ç­‰çš„ä¿¡æ¯ï¼ˆå…¶å®è¿™æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ª<code>å®‰å…¨æœºåˆ¶</code>ï¼šå½“è·¨åŸŸåŠ è½½çš„è„šæœ¬ä¸­å‘ç”Ÿè¯­æ³•é”™è¯¯æ—¶ï¼Œæµè§ˆå™¨å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¸ä¼šæŠ¥å‘Šé”™è¯¯çš„ç»†èŠ‚ï¼Œè€ŒåªæŠ¥å‘Šç®€å•çš„ <code>Script error</code>ã€‚æµè§ˆå™¨åªå…è®¸åŒåŸŸä¸‹çš„è„šæœ¬æ•è·å…·ä½“é”™è¯¯ä¿¡æ¯ï¼Œè€Œå…¶ä»–è„šæœ¬åªçŸ¥é“å‘ç”Ÿäº†ä¸€ä¸ªé”™è¯¯ï¼Œä½†æ— æ³•è·çŸ¥é”™è¯¯çš„å…·ä½“å†…å®¹ï¼ˆæ§åˆ¶å°ä»ç„¶å¯ä»¥çœ‹åˆ°ï¼ŒJS è„šæœ¬æ— æ³•æ•è·ï¼‰</p> <ul><li><p>è§£å†³æ­¥éª¤</p> <ol><li><p>æ·»åŠ <code>crossorigin=&quot;anonymous&quot;</code>å±æ€§ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script
  src<span class="token operator">=</span><span class="token string">&quot;http://crossorigin/texterror.js&quot;</span>
  crossorigin<span class="token operator">=</span><span class="token string">&quot;anonymous&quot;</span>
<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>é™æ€èµ„æºæ‰€åœ¨æœåŠ¡å™¨æ”¯æŒ <code>CORS</code></p></li></ol></li></ul> <h2 id="æ¡†æ¶å†…é”™è¯¯"><a href="#æ¡†æ¶å†…é”™è¯¯" class="header-anchor">#</a> æ¡†æ¶å†…é”™è¯¯</h2> <p>æ¡†æ¶å†…é”™è¯¯æ•è·ä¸€èˆ¬æŒ‡çš„æ˜¯åœ¨ Vueã€React æ¡†æ¶å†…çš„é”™è¯¯æ•è·æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆè¦ç‹¬ç«‹å¼€ï¼Ÿæ¡†æ¶å†…æœ‰è‡ªå·±çš„é”™è¯¯æ•è·æœºåˆ¶.</p> <p><img alt="é”™è¯¯æ•è·.png" data-src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/363768b027f74831a7b65db6bbdbcd2b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?" loading="lazy" class="lazy"></p> <p>ä¸Šå›¾æ˜¯ Vue å†…éƒ¨é”™è¯¯æ•è·çš„é€»è¾‘å›¾ï¼Œå¯¹ä¸€ç»„ä»¶å†…æŠ›å‡ºçš„å¼‚å¸¸å…¶å® Vue å†…éƒ¨æœ‰å¯¹åº”çš„é’©å­å‡½æ•°å¯¹é”™è¯¯è¿›è¡Œæ•è·çš„. åƒä¸€äº›è¿è¡Œæ—¶ JS é”™è¯¯ã€å¼‚æ­¥ promise é”™è¯¯ æ˜¯èƒ½å¤Ÿè¢« handler å¤„ç†å¹¶æ‰§è¡Œæˆ‘ä»¬å®šä¹‰çš„å›è°ƒå‡½æ•°. è€Œä¸ä¼šè¢« window.onerror æˆ–è€… window.addEventListener('error') æ•è·.</p> <blockquote><p>ä¾‹å¤–ï¼šç¬¬ä¸‰æ–¹åº“å†…éƒ¨çš„é”™è¯¯ã€setTimeout é”™è¯¯ã€è¯­æ³•é”™è¯¯è¿™äº›æ˜¯æ²¡åŠæ³•åœ¨æ¡†æ¶å†…è¿›è¡Œæ•è·</p></blockquote> <p>æŠ½å–é”™è¯¯æ•è· sdk çš„æ—¶å€™ç§‰æŒçš„åŸåˆ™æ˜¯å°½é‡å°‘æ”¹åŠ¨ä»£ç ï¼Œå› æ­¤æœ€å¥½æ˜¯ä¸éœ€è¦ç”¨æˆ·åœ¨ Vue.prototype.errorHandler å»æ·»åŠ é¢å¤–ä»£ç ï¼Œåªéœ€å¼•å…¥ sdk script å°±å¥½ï¼Œé‚£è¿™æ—¶å€™å°±éœ€è¦å»é‡å†™æ•è·é€»è¾‘. Vue å¦‚æœä¸å­˜åœ¨ errorHandler çš„è¯æœ€ç»ˆä¼šé€šè¿‡ console.error è¾“å‡ºé”™è¯¯ï¼Œå› æ­¤å¯ä»¥é€šè¿‡é‡å†™ console.errorï¼Œåœ¨é‡Œé¢å®šä¹‰é”™è¯¯è§£æ &amp; ä¸ŠæŠ¥é€»è¾‘æ¥ç®€åŒ–ä½¿ç”¨æˆæœ¬. (<em>iframe ä½œä¸ºé”™è¯¯ä¸ŠæŠ¥æ¡¥æ¢</em>)</p> <h1 id="å‰ç«¯é”™è¯¯ä¸ŠæŠ¥"><a href="#å‰ç«¯é”™è¯¯ä¸ŠæŠ¥" class="header-anchor">#</a> å‰ç«¯é”™è¯¯ä¸ŠæŠ¥</h1> <p>é”™è¯¯ä¸ŠæŠ¥çš„è¿‡ç¨‹æ¶‰åŠé”™è¯¯ä¸ŠæŠ¥çš„æ–¹å¼ &amp; æ—¶æœº.</p> <ul><li>é”™è¯¯ä¸ŠæŠ¥çš„æ–¹å¼å¯ä»¥åˆ†ä¸ºï¼šbeaconã€imageã€request.</li> <li>ä¸ŠæŠ¥æ—¶æœºä¸åŒé¡¹ç›®çš„å®šä¹‰ä¼šæœ‰å·®å¼‚
<ul><li>æ¯”è¾ƒå¸¸è§çš„ä¸€ç§æ˜¯åœ¨é¡µé¢å¸è½½å‰çš„é€‚å½“æ—¶æœºè¿›è¡Œä¸ŠæŠ¥ï¼ˆä¸é˜»å¡ä¸»è¿›ç¨‹ï¼‰</li> <li>åœ¨æµè§ˆå™¨ç©ºé—²çš„æ—¶å€™ä¸ŠæŠ¥ï¼ˆrequestIdleCallbackï¼‰</li></ul></li></ul> <h2 id="beacon"><a href="#beacon" class="header-anchor">#</a> beacon</h2> <ul><li>é€‚ç”¨åœºæ™¯ï¼šä¸ŠæŠ¥æ•°æ®é‡å°‘ã€åœ¨é¡µé¢å¸è½½å‰é€‚å½“æ—¶æœºä¸ŠæŠ¥</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">beacon</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> navigator<span class="token punctuation">.</span><span class="token function">sendBeacon</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>ï¼Ÿï¼Ÿï¼ŸçŸ¥è¯†å­˜ç–‘</p></blockquote> <h2 id="image"><a href="#image" class="header-anchor">#</a> image</h2> <ul><li><p>ä¼˜åŠ¿</p> <ul><li>å¯ä»¥è·¨åŸŸå‘é€è¯·æ±‚</li> <li>ä¸éœ€è¦ç­‰å¾…è¯·æ±‚è¿”å›</li></ul></li> <li><p>ç¼ºç‚¹</p> <ul><li>url æœ‰é•¿åº¦é™åˆ¶ï¼Œæ•°æ®å¤ªå¤šä¼šå¯¼è‡´éƒ¨åˆ†ä¸¢å¤±</li></ul></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">imgRequest</span><span class="token punctuation">(</span>data<span class="token operator">:</span> ReportData<span class="token punctuation">,</span> url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">requestFun</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> spliceStr <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token string">&quot;?&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&amp;&quot;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>spliceStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">data=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>
      <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">addFn</span><span class="token punctuation">(</span>requestFun<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸ŠæŠ¥é˜Ÿåˆ—</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="request"><a href="#request" class="header-anchor">#</a> request</h2> <ul><li>ä¼˜åŠ¿
<ul><li>æ²¡æœ‰æ•°æ®é•¿åº¦ã€æ•°æ®æ ¼å¼é™åˆ¶</li></ul></li> <li>ç¼ºç‚¹
<ul><li>éœ€è¦é…ç½®è·¨åŸŸ</li></ul></li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">xhrPost</span><span class="token punctuation">(</span>data<span class="token operator">:</span> ReportData<span class="token punctuation">,</span> url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">requestFun</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      method<span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
      headers<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">addFn</span><span class="token punctuation">(</span>requestFun<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>ä¸ŠæŠ¥å°è£…</p></blockquote> <p>ä¸Šè¯‰ image &amp; request å…¶å®éƒ½ç”¨åˆ°äº†ä¸€ä¸ª addFn å‡½æ•° so whyï¼Ÿå…¶å®ä¸ŠæŠ¥å¹¶ä¸æ˜¯è¯´é”™è¯¯å‘ç”Ÿäº†é©¬ä¸Šå°±ä¸ŠæŠ¥çš„è¿‡ç¨‹ï¼Œå°±åƒä¸Šé¢è¯´çš„æœ‰æ—¶æœºçš„æ§åˆ¶. é‚£å…·ä½“åˆ° image &amp; request çš„ä¸ŠæŠ¥æ—¶æœºåº”è¯¥æ˜¯åœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´æˆ–è€…æ˜¯é€šè¿‡å¼‚æ­¥çš„æ–¹å¼ä»è€Œé¿å…é˜»å¡ä¸»è¿›ç¨‹.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Queue</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">addFn</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ”¶é›†éœ€è¦ä¸ŠæŠ¥çš„å‡½æ•°</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>requestIdleCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">requestIdleCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">flushFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">flushFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">flushFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¸ŠæŠ¥å½“å‰ä¸­çš„æ•°æ®</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h1 id="å‰ç«¯é”™è¯¯å®šä½"><a href="#å‰ç«¯é”™è¯¯å®šä½" class="header-anchor">#</a> å‰ç«¯é”™è¯¯å®šä½</h1> <p>çº¿ä¸Šåº”ç”¨éƒ¨ç½²çš„è¿‡ç¨‹ï¼š</p> <ul><li>æ„å»ºå·¥å…·ä»å…¥å£æ–‡ä»¶å¼€å§‹ç¼–è¯‘ä»£ç ï¼ˆVue æ¨¡æ¿ç¼–è¯‘ï¼‰</li> <li>ç”Ÿæˆç¼–è¯‘ chunk æ–‡ä»¶ï¼ˆä»£ç æ··æ·†ï¼‰</li> <li>æ³¨å…¥ html å¼•å…¥</li></ul> <p>èƒŒæ™¯ï¼šå¼•å…¥ js èµ„æºé€šå¸¸éƒ½æ˜¯ç¼–è¯‘æ··æ·†å¥½çš„ chunk æ–‡ä»¶ï¼ˆscript èµ„æºæ˜æ–‡ä¼ è¾“å¯¼è‡´æºç æš´éœ² &amp; èŠ‚çœä½“ç§¯ï¼‰ï¼Œå› æ­¤é€šå¸¸é”™è¯¯æŠ›å‡ºçš„æ–‡ä»¶éƒ½ä¼šæ˜¾ç¤ºä¸º [filename].[hash].jsï¼Œæ²¡åŠæ³•çœŸæ­£å®šä½åˆ° Vue / React ç»„ä»¶. å› æ­¤éœ€è¦ä¸€ä¸ªæ˜ å°„çš„è¿‡ç¨‹ï¼Œé€šè¿‡æŠ¥é”™ä¿¡æ¯ç»™å‡ºçš„é”™è¯¯æ–‡ä»¶ã€é”™è¯¯è¡Œå·ã€é”™è¯¯åˆ—å·å®šä½åˆ°æºä»£ç çš„ä½ç½®.</p> <p>è§£å†³ï¼šSourcemap ç»´æŠ¤äº†æ··æ·†åçš„ä»£ç è¡Œåˆ—åˆ°åŸä»£ç è¡Œåˆ—çš„æ˜ å°„å…³ç³»ï¼Œæ ¹æ®æ··æ·†åçš„è¡Œåˆ—å·ï¼Œå°±èƒ½å¤Ÿè·å¾—å¯¹åº”çš„åŸå§‹ä»£ç çš„è¡Œåˆ—å·ï¼Œç»“åˆæºä»£ç æ–‡ä»¶ä¾¿å¯å®šä½åˆ°çœŸå®çš„æŠ¥é”™ä½ç½®</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token comment">// soucemap ç‰ˆæœ¬</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>

  <span class="token comment">// è½¬æ¢åçš„æ–‡ä»¶å</span>

  <span class="token property">&quot;file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;js/app.a2a3ceec.js&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// è½¬æ¢å‰çš„æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œå¦‚æœä¸è½¬æ¢å‰çš„æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ï¼Œè¯¥é¡¹ä¸ºç©º</span>
  <span class="token property">&quot;sourceRoot&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>

  <span class="token comment">// è½¬æ¢å‰çš„æ–‡ä»¶ï¼Œè¯¥é¡¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºå¯èƒ½å­˜åœ¨å¤šä¸ªæ–‡ä»¶åˆå¹¶</span>
  <span class="token property">&quot;sources&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;webpack://web-see-demo/./src/App.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack://web-see-demo/./src/main.js&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// è½¬æ¢å‰çš„æ‰€æœ‰å˜é‡åå’Œå±æ€§å</span>
  <span class="token property">&quot;names&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">// åŸå§‹æ–‡ä»¶å†…å®¹</span>
  <span class="token property">&quot;sourcesContent&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;const add = (x,y) =&gt; {\n  return x+y;\n}&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">// è®°å½•ä½ç½®ä¿¡æ¯çš„å­—ç¬¦ä¸²</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token string">&quot;AAAA,IAAM,GAAG,GAAG,UAAC,CAAQ,EAAC,CAAQ;IAC5B,OAAO,CAAC,GAAC,CAAC,CAAC;AACb,CAAC,CAAA&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><blockquote><p>ï¼Œmapping é‡‡ç”¨å¯å˜é•¿ VLQ ç¼–ç æ ‡è¯†ç€æºæ–‡ä»¶çš„ä¿¡æ¯ <a href="http://ruanyifeng.com/blog/2013/01/javascript_source_map.html" target="_blank" rel="noopener noreferrer">é˜®ä¸€å³°<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ul><li><p>ç¬¬ä¸€ä½ï¼Œè¡¨ç¤ºè¿™ä¸ªä½ç½®åœ¨ï¼ˆè½¬æ¢åçš„ä»£ç çš„ï¼‰çš„ç¬¬å‡ åˆ—ã€‚</p></li> <li><p>ç¬¬äºŒä½ï¼Œè¡¨ç¤ºè¿™ä¸ªä½ç½®å±äº sources å±æ€§ä¸­çš„å“ªä¸€ä¸ªæ–‡ä»¶ã€‚</p></li> <li><p>ç¬¬ä¸‰ä½ï¼Œè¡¨ç¤ºè¿™ä¸ªä½ç½®å±äºè½¬æ¢å‰ä»£ç çš„ç¬¬å‡ è¡Œã€‚</p></li> <li><p>ç¬¬å››ä½ï¼Œè¡¨ç¤ºè¿™ä¸ªä½ç½®å±äºè½¬æ¢å‰ä»£ç çš„ç¬¬å‡ åˆ—ã€‚</p></li> <li><p>ç¬¬äº”ä½ï¼Œè¡¨ç¤ºè¿™ä¸ªä½ç½®å±äº names å±æ€§ä¸­çš„å“ªä¸€ä¸ªå˜é‡ã€‚</p></li></ul> <p><img src="capture.assets/image.png
" style="display:block;margin:auto;"></p> <h2 id="æ˜ å°„è¿‡ç¨‹"><a href="#æ˜ å°„è¿‡ç¨‹" class="header-anchor">#</a> æ˜ å°„è¿‡ç¨‹</h2> <p>npm ä¸­æœ‰ä¸€äº›ç°æˆçš„åº“å¯ä»¥å®ç°æºç æ˜ å°„</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> sourceMap <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'source-map'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test.js.map'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> consumer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">sourceMap<span class="token punctuation">.</span>SourceMapConsumer</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

consumer<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> line <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token number">112003</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">originPositionFor</span><span class="token punctuation">(</span><span class="token punctuation">{</span> line<span class="token punctuation">,</span> column <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      c
       <span class="token punctuation">.</span><span class="token function">sourceContentFor</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>source<span class="token punctuation">)</span>
       <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>line <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>line <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></div> <footer class="page-edit page-editor"><div class="edit-link"><a href="https://github.com/jzyismylover/ubuntu-markdown/edit/docs/fronted/monitor/errorCapture/capture.md" target="_blank" rel="noopener noreferrer">å®Œå–„é¡µé¢</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">æœ€è¿‘æ›´æ–°:</span> <span class="time">3/17/2024, 9:24:20 AM</span></div></footer> <div class="page-nav page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/markdown/electron-builder/" class="prev">
        electron-builder
      </a></span> <span class="next"><a href="/markdown/performance/">
        æ€§èƒ½ä¼˜åŒ–
      </a>
      â†’
    </span></p></div></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">å‰ç«¯é”™è¯¯æ•è·</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/markdown/capture/#è¿è¡Œæ—¶é”™è¯¯" class="toc-sidebar-link">è¿è¡Œæ—¶é”™è¯¯</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#é™æ€èµ„æºé”™è¯¯" class="toc-sidebar-link">é™æ€èµ„æºé”™è¯¯</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#promise-é”™è¯¯" class="toc-sidebar-link">Promise é”™è¯¯</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#http-é”™è¯¯" class="toc-sidebar-link">HTTP é”™è¯¯</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#è·¨åŸŸè„šæœ¬é”™è¯¯" class="toc-sidebar-link">è·¨åŸŸè„šæœ¬é”™è¯¯</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#æ¡†æ¶å†…é”™è¯¯" class="toc-sidebar-link">æ¡†æ¶å†…é”™è¯¯</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#beacon" class="toc-sidebar-link">beacon</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#image" class="toc-sidebar-link">image</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#request" class="toc-sidebar-link">request</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/capture/#æ˜ å°„è¿‡ç¨‹" class="toc-sidebar-link">æ˜ å°„è¿‡ç¨‹</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div>  <div></div></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><!----></div></div>
    <script src="/markdown/assets/js/app.085aa012.js" defer></script><script src="/markdown/assets/js/2.773263cd.js" defer></script><script src="/markdown/assets/js/42.19b2951c.js" defer></script>
  </body>
</html>
