<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue-element-plus-admin | Mr.Jiang-技术博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="">
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?2675818a983a3131404cee835018f016";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script>
    <meta name="description" content="学习&amp;工作-技术积累">
    
    <link rel="preload" href="/markdown/assets/css/0.styles.5474aed4.css" as="style"><link rel="preload" href="/markdown/assets/js/app.085aa012.js" as="script"><link rel="preload" href="/markdown/assets/js/2.773263cd.js" as="script"><link rel="preload" href="/markdown/assets/js/85.c7258f01.js" as="script"><link rel="prefetch" href="/markdown/assets/js/1.50bc9635.js"><link rel="prefetch" href="/markdown/assets/js/10.121e7e8f.js"><link rel="prefetch" href="/markdown/assets/js/11.5205ffab.js"><link rel="prefetch" href="/markdown/assets/js/12.fef29d74.js"><link rel="prefetch" href="/markdown/assets/js/13.b581db50.js"><link rel="prefetch" href="/markdown/assets/js/14.07202c28.js"><link rel="prefetch" href="/markdown/assets/js/15.9aedb95a.js"><link rel="prefetch" href="/markdown/assets/js/16.dd97e264.js"><link rel="prefetch" href="/markdown/assets/js/17.8eb943fb.js"><link rel="prefetch" href="/markdown/assets/js/18.942cde78.js"><link rel="prefetch" href="/markdown/assets/js/19.44710683.js"><link rel="prefetch" href="/markdown/assets/js/20.22d46747.js"><link rel="prefetch" href="/markdown/assets/js/21.aa8b4011.js"><link rel="prefetch" href="/markdown/assets/js/22.b40024cc.js"><link rel="prefetch" href="/markdown/assets/js/23.ace5d346.js"><link rel="prefetch" href="/markdown/assets/js/24.2405d60a.js"><link rel="prefetch" href="/markdown/assets/js/25.c08a85e2.js"><link rel="prefetch" href="/markdown/assets/js/26.c4c5f267.js"><link rel="prefetch" href="/markdown/assets/js/27.b91e5849.js"><link rel="prefetch" href="/markdown/assets/js/28.b80c3633.js"><link rel="prefetch" href="/markdown/assets/js/29.594ec447.js"><link rel="prefetch" href="/markdown/assets/js/3.9d4223ad.js"><link rel="prefetch" href="/markdown/assets/js/30.324e278d.js"><link rel="prefetch" href="/markdown/assets/js/31.43dc2191.js"><link rel="prefetch" href="/markdown/assets/js/32.3fb01abd.js"><link rel="prefetch" href="/markdown/assets/js/33.5a2693b9.js"><link rel="prefetch" href="/markdown/assets/js/34.637d4661.js"><link rel="prefetch" href="/markdown/assets/js/35.eccfebaa.js"><link rel="prefetch" href="/markdown/assets/js/36.c13df5f5.js"><link rel="prefetch" href="/markdown/assets/js/37.9890e89c.js"><link rel="prefetch" href="/markdown/assets/js/38.b33827f2.js"><link rel="prefetch" href="/markdown/assets/js/39.3a1ace37.js"><link rel="prefetch" href="/markdown/assets/js/4.27d6f5b1.js"><link rel="prefetch" href="/markdown/assets/js/40.4396d4c2.js"><link rel="prefetch" href="/markdown/assets/js/41.afe775e0.js"><link rel="prefetch" href="/markdown/assets/js/42.19b2951c.js"><link rel="prefetch" href="/markdown/assets/js/43.7c3256ea.js"><link rel="prefetch" href="/markdown/assets/js/44.7da308e4.js"><link rel="prefetch" href="/markdown/assets/js/45.89b2fd21.js"><link rel="prefetch" href="/markdown/assets/js/46.e817e45d.js"><link rel="prefetch" href="/markdown/assets/js/47.c56ee626.js"><link rel="prefetch" href="/markdown/assets/js/48.59541039.js"><link rel="prefetch" href="/markdown/assets/js/49.bc7ad96a.js"><link rel="prefetch" href="/markdown/assets/js/5.2637f2cc.js"><link rel="prefetch" href="/markdown/assets/js/50.9d0dc446.js"><link rel="prefetch" href="/markdown/assets/js/51.4d949834.js"><link rel="prefetch" href="/markdown/assets/js/52.90aa4f80.js"><link rel="prefetch" href="/markdown/assets/js/53.67b77129.js"><link rel="prefetch" href="/markdown/assets/js/54.3535db37.js"><link rel="prefetch" href="/markdown/assets/js/55.9efbe9e5.js"><link rel="prefetch" href="/markdown/assets/js/56.e8aa37ba.js"><link rel="prefetch" href="/markdown/assets/js/57.af66ff8f.js"><link rel="prefetch" href="/markdown/assets/js/58.0415674f.js"><link rel="prefetch" href="/markdown/assets/js/59.b09373ca.js"><link rel="prefetch" href="/markdown/assets/js/6.61bacfb8.js"><link rel="prefetch" href="/markdown/assets/js/60.d07cb515.js"><link rel="prefetch" href="/markdown/assets/js/61.ec2b2da7.js"><link rel="prefetch" href="/markdown/assets/js/62.44a5a0b8.js"><link rel="prefetch" href="/markdown/assets/js/63.09e39adc.js"><link rel="prefetch" href="/markdown/assets/js/64.b9ee085d.js"><link rel="prefetch" href="/markdown/assets/js/65.026450b0.js"><link rel="prefetch" href="/markdown/assets/js/66.a3571972.js"><link rel="prefetch" href="/markdown/assets/js/67.5a8616c4.js"><link rel="prefetch" href="/markdown/assets/js/68.6fdda787.js"><link rel="prefetch" href="/markdown/assets/js/69.691ff5d7.js"><link rel="prefetch" href="/markdown/assets/js/7.32a4bd87.js"><link rel="prefetch" href="/markdown/assets/js/70.b401009e.js"><link rel="prefetch" href="/markdown/assets/js/71.6b3bcefe.js"><link rel="prefetch" href="/markdown/assets/js/72.dcd8145e.js"><link rel="prefetch" href="/markdown/assets/js/73.cc81c046.js"><link rel="prefetch" href="/markdown/assets/js/74.856f40f0.js"><link rel="prefetch" href="/markdown/assets/js/75.746590de.js"><link rel="prefetch" href="/markdown/assets/js/76.8ddba5b5.js"><link rel="prefetch" href="/markdown/assets/js/77.16644476.js"><link rel="prefetch" href="/markdown/assets/js/78.e89fc885.js"><link rel="prefetch" href="/markdown/assets/js/79.1193b665.js"><link rel="prefetch" href="/markdown/assets/js/80.9475cd89.js"><link rel="prefetch" href="/markdown/assets/js/81.8d99d275.js"><link rel="prefetch" href="/markdown/assets/js/82.80eb3e2f.js"><link rel="prefetch" href="/markdown/assets/js/83.fe14141e.js"><link rel="prefetch" href="/markdown/assets/js/84.9647a2db.js"><link rel="prefetch" href="/markdown/assets/js/86.1a5782f4.js"><link rel="prefetch" href="/markdown/assets/js/87.e7354607.js"><link rel="prefetch" href="/markdown/assets/js/vendors~docsearch.54f2532f.js">
    <link rel="stylesheet" href="/markdown/assets/css/0.styles.5474aed4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/markdown/" class="home-link router-link-active"><img src="/markdown/logo.png" alt="Mr.Jiang-技术博客" class="logo"> <span class="site-name can-hide">Mr.Jiang-技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/jzyismylover/ubuntu-markdown" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/jzyismylover/ubuntu-markdown" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vue-element-plus-admin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/markdown/vue-element-plus-admin-docs/#layout" class="sidebar-link">layout</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#菜单" class="sidebar-link">菜单</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#后端生成" class="sidebar-link" style="padding-left:3rem;">后端生成</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#前端生成" class="sidebar-link" style="padding-left:3rem;">前端生成</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#渲染菜单" class="sidebar-link" style="padding-left:3rem;">渲染菜单</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#工具栏" class="sidebar-link">工具栏</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#面包屑" class="sidebar-link" style="padding-left:3rem;">面包屑</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#路由标签页" class="sidebar-link">路由标签页</a></li></ul></li><li><a href="/markdown/vue-element-plus-admin-docs/#dashboard" class="sidebar-link">dashboard</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#count-vue" class="sidebar-link">Count.vue</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#echarts-vue" class="sidebar-link">Echarts.vue</a></li></ul></li><li><a href="/markdown/vue-element-plus-admin-docs/#guide" class="sidebar-link">guide</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/markdown/vue-element-plus-admin-docs/#components" class="sidebar-link">components</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#表单" class="sidebar-link">表单</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#表格" class="sidebar-link">表格</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#编辑器" class="sidebar-link">编辑器</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#富文本编辑器" class="sidebar-link" style="padding-left:3rem;">富文本编辑器</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#json-编辑器" class="sidebar-link" style="padding-left:3rem;">JSON 编辑器</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#图片预览" class="sidebar-link">图片预览</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#图标" class="sidebar-link">图标</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#二维码" class="sidebar-link">二维码</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#高亮" class="sidebar-link">高亮</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#密码强度" class="sidebar-link">密码强度</a></li><li class="sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#瀑布流" class="sidebar-link">瀑布流</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="content"><div class="content-wrapper" style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="vue-element-plus-admin"><a href="#vue-element-plus-admin" class="header-anchor">#</a> vue-element-plus-admin</h1> <blockquote><p>基于 <code>vue3</code>、<code>typescript</code>、<code>element-plus</code>、<code>tailwindCSS</code> 多功能的后台管理系统</p></blockquote> <h2 id="layout"><a href="#layout" class="header-anchor">#</a> layout</h2> <p>从整体 <code>layout</code> 来说，默认的布局方式：左菜单、右内容区。内容区又可以细分为</p> <ul><li>顶部工具：包括面包屑、全屏、切换语言、个人信息</li> <li>tabs 标签：展示路由操作历史，可跳转、关闭、刷新</li> <li>内容区：展示每个菜单对应的内容 ( <code>&lt;router-view /&gt;</code> )</li> <li>footer：copyright 显示</li></ul> <img src="/home/jzy/Documents/markdown/source-code/vue-element-plus-admin.docs.assets/image-20231030223944167.png" style="display:block;margin:auto;"> <p>布局不难实现，主要是能够实现布局可配置化</p> <img src="/home/jzy/Documents/markdown/source-code/vue-element-plus-admin.docs.assets/image-20231030224418441.png" style="display:block;margin:auto;"> <p>布局可配置化指的是用户能够通过自定义设置来展示 UI，如上，用户可配置菜单显隐、系统主题、头部主题……，因此就必须代码组织必须灵活。</p> <p><strong><code>store/modules/app.ts</code></strong>：这个 <code>pinia store</code> 集成了所有可配置系统选项，个人认为可以概括为两部分</p> <ul><li>一次性配置：面包屑、折叠菜单、标签页…… 这些可以理解为是对系统的控件进行配置</li> <li>持久性配置：系统主题、组件尺寸、动态路由……这些可以理解为是系统级别配置</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// pinia structure</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> useAppStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&quot;app&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AppState <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 计算属性</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 可在非 setup 外使用</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useAppStoreWithOut</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">useAppStore</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>在 <code>state</code> 中定义配置选项，在 <code>getters</code> 中暴露获取配置选项的方法，个人感觉这是个比较好的模式</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        mobile<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        pageLoading<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">getMobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mobile
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">getPageLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageLoading
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>配置总体可分为</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> source <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      // 面包屑
      breadcrumb: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getBreadcrumb<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 面包屑图标
      breadcrumbIcon: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getBreadcrumbIcon<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 折叠图标
      hamburger: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getHamburger<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 全屏图标
      screenfull: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getScreenfull<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 尺寸图标
      size: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getSize<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 多语言图标
      locale: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getLocale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 标签页
      tagsView: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTagsView<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 标签页图标
      getTagsViewIcon: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTagsViewIcon<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // logo
      logo: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getLogo<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 菜单手风琴
      uniqueOpened: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getUniqueOpened<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 固定header
      fixedHeader: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getFixedHeader<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 页脚
      footer: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getFooter<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 灰色模式
      greyMode: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getGreyMode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // layout布局
      layout: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getLayout<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
      // 暗黑模式
      isDark: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getIsDark<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,
      // 组件尺寸
      currentSize: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getCurrentSize<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
      // 主题相关
      theme: {
        // 主题色
        elColorPrimary: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>elColorPrimary<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 左侧菜单边框颜色
        leftMenuBorderColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>leftMenuBorderColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 左侧菜单背景颜色
        leftMenuBgColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>leftMenuBgColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 左侧菜单浅色背景颜色
        leftMenuBgLightColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>leftMenuBgLightColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 左侧菜单选中背景颜色
        leftMenuBgActiveColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>leftMenuBgActiveColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 左侧菜单收起选中背景颜色
        leftMenuCollapseBgActiveColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>leftMenuCollapseBgActiveColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 左侧菜单字体颜色
        leftMenuTextColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>leftMenuTextColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 左侧菜单选中字体颜色
        leftMenuTextActiveColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>leftMenuTextActiveColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // logo字体颜色
        logoTitleTextColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>logoTitleTextColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // logo边框颜色
        logoBorderColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>logoBorderColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 头部背景颜色
        topHeaderBgColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>topHeaderBgColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 头部字体颜色
        topHeaderTextColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>topHeaderTextColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 头部悬停颜色
        topHeaderHoverColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>topHeaderHoverColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">',
        // 头部边框颜色
        topToolBorderColor: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appStore<span class="token punctuation">.</span>getTheme<span class="token punctuation">.</span>topToolBorderColor<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'
      }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><blockquote><p>实现可配置化的布局</p></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> appStore <span class="token operator">=</span> <span class="token function">useAppStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pinia 配置状态存储</span>
<span class="token keyword">const</span> <span class="token function-variable function">renderLayout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> layout <span class="token operator">=</span> appStore<span class="token punctuation">.</span>getLayout<span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">unref</span><span class="token punctuation">(</span>layout<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;classic&quot;</span><span class="token operator">:</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> renderClassic <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRenderLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">renderClassic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;topLeft&quot;</span><span class="token operator">:</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> renderTopLeft <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRenderLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">renderTopLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;top&quot;</span><span class="token operator">:</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> renderTop <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRenderLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">renderTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;cutMenu&quot;</span><span class="token operator">:</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> renderCutMenu <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRenderLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">renderCutMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">renderClassic</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
         </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
          <span class="token attr-name">class</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prefixCls<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-content</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
            <span class="token string">'absolute top-0 h-[100%]'</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              <span class="token comment">/* 折叠菜单 */</span>
              <span class="token string-property property">'w-[calc(100%-var(--left-menu-min-width))] left-[var(--left-menu-min-width)]'</span><span class="token operator">:</span>
                collapse<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>mobile<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
               <span class="token comment">/* 展开菜单 */</span>
              <span class="token string-property property">'w-[calc(100%-var(--left-menu-max-width))] left-[var(--left-menu-max-width)]'</span><span class="token operator">:</span>
                <span class="token operator">!</span>collapse<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>mobile<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
              <span class="token string-property property">'fixed !w-full !left-0'</span><span class="token operator">:</span> mobile<span class="token punctuation">.</span>value
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">}</span></span>
          <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">transition</span><span class="token punctuation">:</span> all <span class="token function">var</span><span class="token punctuation">(</span>--transition-time-02<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span>
        <span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    )
}
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>参考上面部分 <code>jsx</code>，项目可配置化基于 <code>css variables</code> 来控制，在 <code>:root</code> 上挂载一些 <code>css 变量</code>，然后通过选项配置、配合 <code>tailwindCSS</code> 动态设置 <code>classname</code> 改变布局</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">:root</span> <span class="token punctuation">{</span>
  <span class="token property">--left-menu-max-width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">--left-menu-min-width</span><span class="token punctuation">:</span> 64px<span class="token punctuation">;</span>
  <span class="token property">--transition-time-02</span><span class="token punctuation">:</span> 0.2s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>!!! <code>less</code> 变量</p></blockquote> <p><code>hooks</code> 里面有一个 <code>useDesign</code> 方法，暴露出全局 <code>css</code> 命名前缀，而变量的导出则是通过 <code>CSS Module</code> 的方式在 less 文件导出变量</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> variables <span class="token keyword">from</span> <span class="token string">&quot;@/styles/variables.module.less&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useDesign</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> lessVariables <span class="token operator">=</span> variables<span class="token punctuation">;</span>

  <span class="token comment">/**
   * @param scope 类名
   * @returns 返回空间名-类名
   */</span>
  <span class="token keyword">const</span> <span class="token function-variable function">getPrefixCls</span> <span class="token operator">=</span> <span class="token punctuation">(</span>scope<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>lessVariables<span class="token punctuation">.</span><span class="token keyword">namespace</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scope<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    variables<span class="token operator">:</span> lessVariables<span class="token punctuation">,</span>
    getPrefixCls<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-less line-numbers-mode"><pre class="language-less"><code><span class="token comment">/* variables.module.less */</span>

<span class="token comment">// 命名空间</span>
<span class="token variable">@namespace<span class="token punctuation">:</span></span> v<span class="token punctuation">;</span>
<span class="token comment">// el命名空间</span>
<span class="token variable">@elNamespace<span class="token punctuation">:</span></span> el<span class="token punctuation">;</span>

<span class="token comment">// 导出变量</span>
<span class="token selector">:export</span> <span class="token punctuation">{</span>
  <span class="token property">namespace</span><span class="token punctuation">:</span> <span class="token variable">@namespace</span><span class="token punctuation">;</span>
  <span class="token property">elNamespace</span><span class="token punctuation">:</span> <span class="token variable">@elNamespace</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>其实我一直对于颜色配置有个疑问，在配置面板配置颜色后其实并不会说所有的容器的背景色都会发生变化，而是在黑白才会有明显的区分，怎么做到对颜色亮度的衡量区分？</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* colorIsDark */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">colorIsDark</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">color</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isHexColor</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">hexToRGB</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?:\(|\)|rgb|RGB)*</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">Number</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> r <span class="token operator">*</span> <span class="token number">0.299</span> <span class="token operator">+</span> g <span class="token operator">*</span> <span class="token number">0.578</span> <span class="token operator">+</span> b <span class="token operator">*</span> <span class="token number">0.114</span> <span class="token operator">&lt;</span> <span class="token number">192</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="菜单"><a href="#菜单" class="header-anchor">#</a> 菜单</h3> <img src="/home/jzy/Documents/markdown/source-code/vue-element-plus-admin.docs.assets/image-20231105101542241.png" style="display:block;margin:auto;"> <blockquote><p>菜单主题怎么去配置？总体有以下一些配置选项</p></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> theme<span class="token operator">:</span> Recordable <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 左侧菜单边框颜色</span>
  leftMenuBorderColor<span class="token operator">:</span> isDarkColor <span class="token operator">?</span> <span class="token string">&quot;inherit&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;#eee&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 左侧菜单背景颜色</span>
  leftMenuBgColor<span class="token operator">:</span> color<span class="token punctuation">,</span>
  <span class="token comment">// 左侧菜单浅色背景颜色</span>
  leftMenuBgLightColor<span class="token operator">:</span> isDarkColor <span class="token operator">?</span> <span class="token function">lighten</span><span class="token punctuation">(</span>color<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">:</span> color<span class="token punctuation">,</span>
  <span class="token comment">// 左侧菜单选中背景颜色</span>
  leftMenuBgActiveColor<span class="token operator">:</span> isDarkColor
    <span class="token operator">?</span> <span class="token string">&quot;var(--el-color-primary)&quot;</span>
    <span class="token operator">:</span> <span class="token function">hexToRGB</span><span class="token punctuation">(</span><span class="token function">unref</span><span class="token punctuation">(</span>primaryColor<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// 左侧菜单收起选中背景颜色</span>
  leftMenuCollapseBgActiveColor<span class="token operator">:</span> isDarkColor
    <span class="token operator">?</span> <span class="token string">&quot;var(--el-color-primary)&quot;</span>
    <span class="token operator">:</span> <span class="token function">hexToRGB</span><span class="token punctuation">(</span><span class="token function">unref</span><span class="token punctuation">(</span>primaryColor<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// 左侧菜单字体颜色</span>
  leftMenuTextColor<span class="token operator">:</span> isDarkColor <span class="token operator">?</span> <span class="token string">&quot;#bfcbd9&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;#333&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 左侧菜单选中字体颜色</span>
  leftMenuTextActiveColor<span class="token operator">:</span> isDarkColor <span class="token operator">?</span> <span class="token string">&quot;#fff&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;var(--el-color-primary)&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// logo字体颜色</span>
  logoTitleTextColor<span class="token operator">:</span> isDarkColor <span class="token operator">?</span> <span class="token string">&quot;#fff&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;inherit&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// logo边框颜色</span>
  logoBorderColor<span class="token operator">:</span> isDarkColor <span class="token operator">?</span> color <span class="token operator">:</span> <span class="token string">&quot;#eee&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><blockquote><p>菜单生成</p></blockquote> <p>菜单生成可以分为三种模式</p> <ul><li>后端生成带权限路由</li> <li>前端生成带权限路由</li> <li>前端使用静态路由</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// premission.ts</span>
    <span class="token function">generateRoutes</span><span class="token punctuation">(</span>
      type<span class="token operator">:</span> <span class="token string">'server'</span> <span class="token operator">|</span> <span class="token string">'frontEnd'</span> <span class="token operator">|</span> <span class="token string">'static'</span><span class="token punctuation">,</span>
      routers<span class="token operator">?</span><span class="token operator">:</span> AppCustomRouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">unknown</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> routerMap<span class="token operator">:</span> AppRouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'server'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 模拟后端过滤菜单</span>
          routerMap <span class="token operator">=</span> <span class="token function">generateRoutesByServer</span><span class="token punctuation">(</span>routers<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'frontEnd'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 模拟前端过滤菜单</span>
          routerMap <span class="token operator">=</span> <span class="token function">generateRoutesByFrontEnd</span><span class="token punctuation">(</span><span class="token function">cloneDeep</span><span class="token punctuation">(</span>asyncRouterMap<span class="token punctuation">)</span><span class="token punctuation">,</span> routers <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 直接读取静态路由表</span>
          routerMap <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>asyncRouterMap<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 动态路由，404一定要放到最后面</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>addRouters <span class="token operator">=</span> routerMap<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">'/:path(.*)*'</span><span class="token punctuation">,</span>
            redirect<span class="token operator">:</span> <span class="token string">'/404'</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">'404Page'</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
              hidden<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              breadcrumb<span class="token operator">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment">// 渲染菜单的所有路由（constantRouterMap 指的是一些无权限路由）</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>routers <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>constantRouterMap<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>routerMap<span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>从上面菜单生成可以看出除了细分为三种不同的路由生成方式，其实还有动态路由、<code>constantRouterMap</code></p> <ul><li>动态路由：作为降级路由，匹配不存在的路径重定向到 404</li> <li><code>constantRouterMap</code>：无权限且不展示的路由项，通常是由前端定义的登陆页、重定向页</li></ul> <h4 id="后端生成"><a href="#后端生成" class="header-anchor">#</a> 后端生成</h4> <p>后端生成首先需要前后端协调好具体的格式以及对应的参数，要点主要有：</p> <ul><li>路径 <code>path</code> 的设定，因为返回的是一个 <code>string</code>，因此需要提前规划好怎么最后把路径映射到对应位置的 <code>vue</code> 文件上</li> <li>原数据 <code>meta</code> 的设定，元数据主要控制权限以及对应路由参数，包括该路由项是否可见，什么角色权限的用户可以访问</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">generateRoutesByServer</span><span class="token punctuation">(</span>routes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> route <span class="token keyword">of</span> routes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">// 作为添加到 vue-router 上的路由项</span>
      path<span class="token operator">:</span> route<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
      name<span class="token operator">:</span> route<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
      redirct<span class="token operator">:</span> route<span class="token punctuation">.</span>reditct<span class="token punctuation">,</span>
      meta<span class="token operator">:</span> route<span class="token punctuation">.</span>meta<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 处理 component(不同 crm 根据各自项目文件命名规范有所不同)</span>
    <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">glob</span><span class="token punctuation">(</span><span class="token string">&quot;../views/**/*.{vue,tsx}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> currentComponent <span class="token operator">=</span>
        modules<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>route<span class="token punctuation">.</span>component<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.vue</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span> <span class="token operator">||</span>
        modules<span class="token punctuation">[</span>
          <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>route<span class="token punctuation">.</span>component<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.tsx</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">]</span> <span class="token comment">/* 基于约定好 route.component为前端组件目录，如 views/src/dashboard/index */</span><span class="token punctuation">,</span>
      component <span class="token operator">=</span> route<span class="token punctuation">.</span>component<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>currentComponent <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>component<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">/* 找不到组件所在且不作为顶层父路由 */</span>
      <span class="token function">warning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      route<span class="token punctuation">.</span>component <span class="token operator">=</span> component <span class="token operator">===</span> <span class="token string">&quot;#&quot;</span> <span class="token operator">?</span> Layout <span class="token operator">:</span> currentComponent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 递归处理 children</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>route<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      route<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token function">generateRoutesByServer</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="前端生成"><a href="#前端生成" class="header-anchor">#</a> 前端生成</h4> <p>其实项目里面 <code>fronted</code> &amp; <code>static</code> 界定有点模糊，从个人的角度，可以理解为就是使用前端定义的静态路由来渲染菜单。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// router.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> aysncRoutes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// permission.ts</span>
routerMap <span class="token operator">=</span> <span class="token function">cloneDeep</span><span class="token punctuation">(</span>asyncRoutes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>生成路由后，就是如何根据路由去生成菜单，总的来说需要做的工作</p></blockquote> <ul><li><p>菜单过滤</p> <ul><li>路由角色过滤，即针对当前用户哪些路由是不可见</li></ul> <blockquote><p>当然不做这方面的过滤也是 ok 的，可以在路由跳转的时候前端再根据当前角色判断是否有权限去进行路由跳转（路由拦截器）</p></blockquote> <ul><li><code>true</code>：顺利跳转到目标页面</li> <li><code>false</code>：重定向到权限申请页面或者给一个全局信息提示</li></ul> <p>👿 看情况吧，如果涉及到权限申请的功能就没必要作这个限制了</p></li> <li><p>区分 <code>menu</code> &amp; <code>menuGroup</code></p> <ul><li><code>menu</code>：单菜单</li> <li><code>menuGroup</code>：菜单分组</li></ul></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">hasOneShowChildren</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> onlyOneChild <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> showChildrenLists <span class="token operator">=</span> children<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>v<span class="token punctuation">.</span>hidden<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            onlyOneChild <span class="token operator">=</span> v
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 只有一个 children</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>showChildrenLists<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            oneShowingChild<span class="token operator">:</span> <span class="token boolean">true</span>
            onlyOneChild<span class="token operator">:</span> <span class="token function">unref</span><span class="token punctuation">(</span>onlyOneChild<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

	<span class="token comment">// 没有 children</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>showChildrenLists<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        onlyOneChild<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>parent<span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> noShowingChildren<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">// noShowingChildren作为该情况标识</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            oneShowingChild<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            onlyOneChild<span class="token operator">:</span> <span class="token function">unref</span><span class="token punctuation">(</span>onlyOneChild<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

	<span class="token comment">// 需递归渲染子路由</span>
	<span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
           oneShowingChild<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
           onlyOneChild<span class="token operator">:</span> <span class="token function">unref</span><span class="token punctuation">(</span>onlyOneChild<span class="token punctuation">)</span>
  		<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="渲染菜单"><a href="#渲染菜单" class="header-anchor">#</a> 渲染菜单</h4> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">renderMenuItem</span><span class="token punctuation">(</span>routes<span class="token punctuation">,</span> parentPath <span class="token operator">=</span> <span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> routes <span class="token operator">=</span> routes <span class="token operator">??</span> permissionStore<span class="token punctuation">.</span>getRoutes
    routes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token operator">?.</span>meta<span class="token operator">?.</span>hidden<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> oneShowingChild<span class="token punctuation">,</span> onlyOneChild <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">hasOneShowChildren</span><span class="token punctuation">(</span>routes<span class="token punctuation">)</span>
            <span class="token keyword">const</span> fullpath <span class="token operator">=</span> <span class="token function">isUrl</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token operator">?</span> path <span class="token operator">:</span> <span class="token function">pathResole</span><span class="token punctuation">(</span>parentPath<span class="token punctuation">,</span> v<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
            <span class="token comment">// 渲染 menu-item</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>oneShowingChild <span class="token operator">&amp;&amp;</span>
              <span class="token punctuation">(</span><span class="token operator">!</span>onlyOneChild<span class="token operator">?.</span>children <span class="token operator">||</span> onlyOneChild<span class="token operator">?.</span>noShowingChildren<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
              <span class="token operator">!</span>meta<span class="token operator">?.</span>alwaysShow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ElMenuItem</span></span> <span class="token attr-name">index</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onlyOneChild <span class="token operator">?</span> <span class="token function">pathResolve</span><span class="token punctuation">(</span>fullpath<span class="token punctuation">,</span> onlyOneChild<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ElMenuItem</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 渲染 submenu(递归 renderMenuItems)</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ElSubMenu</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    </span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                        <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">renderMenuItem</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>children<span class="token operator">!</span><span class="token punctuation">,</span> fullpath<span class="token punctuation">)</span> <span class="token comment">/* 默认插槽 */</span>
                    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ElSubMenu</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="工具栏"><a href="#工具栏" class="header-anchor">#</a> 工具栏</h3> <blockquote><p>工具栏可以有什么配置选项?</p></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token function-variable function">setHeaderTheme</span> <span class="token operator">=</span> <span class="token punctuation">(</span>color<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> isDarkColor <span class="token operator">=</span> <span class="token function">colorIsDark</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> textColor <span class="token operator">=</span> isDarkColor <span class="token operator">?</span> <span class="token string">&quot;#fff&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;inherit&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> textHoverColor <span class="token operator">=</span> isDarkColor <span class="token operator">?</span> <span class="token function">lighten</span><span class="token punctuation">(</span>color<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;#f6f6f6&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> topToolBorderColor <span class="token operator">=</span> isDarkColor <span class="token operator">?</span> color <span class="token operator">:</span> <span class="token string">&quot;#eee&quot;</span><span class="token punctuation">;</span>
  <span class="token function">setCssVar</span><span class="token punctuation">(</span><span class="token string">&quot;--top-header-bg-color&quot;</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setCssVar</span><span class="token punctuation">(</span><span class="token string">&quot;--top-header-text-color&quot;</span><span class="token punctuation">,</span> textColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setCssVar</span><span class="token punctuation">(</span><span class="token string">&quot;--top-header-hover-color&quot;</span><span class="token punctuation">,</span> textHoverColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
  appStore<span class="token punctuation">.</span><span class="token function">setTheme</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 头部背景色</span>
    topHeaderBgColor<span class="token operator">:</span> color<span class="token punctuation">,</span>
    <span class="token comment">// 头部字体颜色</span>
    topHeaderTextColor<span class="token operator">:</span> textColor<span class="token punctuation">,</span>
    <span class="token comment">// 头部悬停颜色</span>
    topHeaderHoverColor<span class="token operator">:</span> textHoverColor<span class="token punctuation">,</span>
    <span class="token comment">// 头部边框颜色</span>
    topToolBorderColor<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">unref</span><span class="token punctuation">(</span>layout<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;top&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setMenuTheme</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="面包屑"><a href="#面包屑" class="header-anchor">#</a> 面包屑</h4> <blockquote><p>面包屑是什么？面包屑是一种“历史记录”的应用方式，让用户比较明确地知道自己所处网站位置。为了浏览体验，一般情况只有 3 级，首页&gt;栏目页&gt;内容页，3 层目录结构可以让用户随时随地的找到自己所在的位置又能保证栏目分类后的各个栏目的权重不至于太分散。</p></blockquote> <p>从具体实现来说：</p> <ol><li>获得当前所在页面路由</li> <li>将所有子路由项的 <code>path</code> 拼接完整 （递归）</li> <li>过滤得到一个满足当前路由路径的路由子项，返回完整的父级路由树（递归）</li> <li>将步骤三得到的路由树平铺为数组</li> <li>循环步骤 4 得到的数组渲染 <code>Breadcrumb</code></li></ol> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/* step 2 */</span>
<span class="token keyword">function</span> <span class="token function">filterBreadcrumb</span><span class="token punctuation">(</span>routes<span class="token punctuation">,</span> parentPath <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> route <span class="token keyword">of</span> routes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> meta <span class="token operator">=</span> route<span class="token punctuation">.</span>meta <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 过滤不可见路由</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>meta<span class="token punctuation">.</span>hidden <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>meta<span class="token punctuation">.</span>canTo<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>

    <span class="token comment">// 只有一个子项</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span>
      <span class="token operator">!</span>meta<span class="token punctuation">.</span>alwaysShow <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">.</span>children<span class="token operator">?.</span>length <span class="token operator">===</span> <span class="token number">1</span>
        <span class="token operator">?</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>route<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            path<span class="token operator">:</span> <span class="token function">pathResolve</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>path<span class="token punctuation">,</span> route<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>route <span class="token punctuation">}</span><span class="token punctuation">;</span>

    data<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token function">pathResolve</span><span class="token punctuation">(</span>parentPath<span class="token punctuation">,</span> data<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 递归</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token function">filterBreadcrumb</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>children<span class="token punctuation">,</span> data<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><blockquote><p><code>step2</code> 目的主要有两个</p> <ol><li><p>过滤掉不可见的路由 <code>/login</code>、<code>/redirct</code>、<code>/error</code>、<code>/</code> （不应该出现在面包屑中）</p></li> <li><p>通过递归整个路由树，将二级甚至多级路由的 <code>path</code> 属性补全为完整路径，方便 <code>step3</code> 进行 <code>filter</code> 匹配</p></li></ol></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/* step 3 */</span>
<span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> filterFunction<span class="token punctuation">,</span> config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* filterFunction: (node) =&gt; node.path === currentPath */</span>
    <span class="token keyword">const</span> children <span class="token operator">=</span> config<span class="token punctuation">.</span>children <span class="token operator">??</span> <span class="token string">'children'</span>
    <span class="token keyword">const</span> <span class="token function-variable function">filterList</span> <span class="token operator">=</span> <span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		list
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span>v <span class="token punctuation">}</span><span class="token punctuation">)</span>
        	<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            	v<span class="token punctuation">.</span>children <span class="token operator">=</span> v<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> <span class="token function">filterList</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>children<span class="token punctuation">,</span> filterFunction<span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token function">filterFunction</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
        	<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">filter</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><blockquote><p><code>step3</code> 实现的逻辑是如果子项满足筛选条件的化就返回带有子项的整个路由树，因此 <code>filter</code> 函数的原则有两个</p> <ol><li>满足 <code>filterFunction</code>：主要针对子项來說，路由是匹配的</li> <li>子項不爲空：主要针对顶层或者父级路由來說，其子項匹配則该父项也应入到最后的結果中</li></ol></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/* step 4 */</span>
<span class="token keyword">function</span> <span class="token function">treeToList</span><span class="token punctuation">(</span>treeLists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  treeLists <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>treeLists<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> treeNode <span class="token keyword">of</span> treeLists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>treeNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">treeToList</span><span class="token punctuation">(</span>treeNode<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>treeNode <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p><code>step4</code> 实现的逻辑可以理解为是一个平铺树的算法题，上面采用基本的递归实现，项目中有一个非常有意思的实现方式</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">treeToList</span><span class="token punctuation">(</span>treeLists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    treeLists <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>treeLists<span class="token punctuation">]</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> treeLists<span class="token punctuation">.</span>length<span class="token punctuation">,</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> item <span class="token operator">=</span> treeLists<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">continue</span> <span class="token punctuation">}</span>
        treeLists<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">...</span>result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> treeLists
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></blockquote> <h3 id="路由标签页"><a href="#路由标签页" class="header-anchor">#</a> 路由标签页</h3> <blockquote><p>路由标签页：提供一个可以让用户切换到之前已经访问过的页面的快捷方式</p></blockquote> <img src="/home/jzy/Documents/markdown/source-code/vue-element-plus-admin.docs.assets/image-20231105155644009.png" style="display:block;margin:auto;"> <p>功能设计：</p> <ol><li>定义 <code>store</code> ，包含访问历史数据、对应 <code>tabs</code> 的操作方法</li> <li>监听当前路由，动态切换 <code>tabs</code>（当 <code>tabs</code> 列表比较长的时候能实现滚动到对应 <code>tabs-item</code>）</li> <li>点击 <code>tab-item</code>，路由切换，页面刷新</li></ol> <p>具体逻辑：</p> <ol><li>初始化 <code>tabs</code>：找出哪些是需要初始就展示的 <code>tabs</code>（固定）</li> <li><code>store</code> 数据&amp;方法定义：定义存储访问过的、目前的 <code>state</code> 以及一系列增删改对应 <code>actions</code> 方法</li> <li>定义 <code>useTagViews</code> 方法，作为 <code>hooks</code> 包含 <code>store</code> 处理方法的同时可额外传入 <code>callback</code></li> <li>根据 <code>vistedTags</code> 渲染 <code>tabs</code> 列表，配置工具栏（刷新、删除当前、删除其他、删除左侧、删除右侧、删除全部）</li> <li>监听路由变化，当路由改变时滚动到对应的 <code>tag</code> 标签 ( <code>scrollLeft</code> )</li></ol> <ul><li><code>Step 3</code></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">filterAffixTags</span><span class="token punctuation">(</span>routes<span class="token punctuation">,</span> parentPath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 固定的 tag 列表</span>
  routes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> meta <span class="token operator">=</span> route<span class="token punctuation">.</span>meta <span class="token operator">??</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> tagPath <span class="token operator">=</span> <span class="token function">pathResolve</span><span class="token punctuation">(</span>parentPath<span class="token punctuation">,</span> route<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>meta<span class="token operator">?.</span>affix<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      tags<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>route<span class="token punctuation">,</span> path<span class="token operator">:</span> tagPath <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>route<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> tempTags <span class="token operator">=</span> <span class="token function">filterAffixTags</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>children<span class="token punctuation">,</span> tagPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      tempTags <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>tags<span class="token punctuation">,</span> <span class="token operator">...</span>tempTags<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> tags<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li><code>Step 2</code></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/* tagsView.ts */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> useTagsViewStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'tagsView'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            vistedTags<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 存储历史访问过的路由记录</span>
            selectedTag<span class="token operator">:</span> <span class="token keyword">null</span>， <span class="token comment">// 存储当前正在访问的路由记录</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>，
   	actions<span class="token operator">:</span> <span class="token punctuation">{</span>
   		<span class="token comment">/* 关闭其他 tabs */</span>
    	<span class="token function">closeAllTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  		  <span class="token keyword">this</span><span class="token punctuation">.</span>visitedViews<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> tag<span class="token operator">?.</span>meta<span class="token operator">?.</span>affix<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token comment">/* 关闭左侧 tabs */</span>
        <span class="token function">closeLeftTags</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> idx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>visitedViews<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>path <span class="token operator">===</span> view<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>visitedViews<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token keyword">return</span> v<span class="token operator">?.</span>meta<span class="token operator">?.</span>affix <span class="token operator">||</span> v<span class="token punctuation">.</span>path <span class="token operator">===</span> view<span class="token punctuation">.</span>path <span class="token operator">||</span> i <span class="token operator">&gt;</span> idx
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token comment">/* 关闭右侧 tabs */</span>
        <span class="token function">closeRightTags</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> idx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>visitedViews<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>v <span class="token operator">=&gt;</span> v<span class="token punctuation">.</span>path <span class="token operator">===</span> view<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
        	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>visitedViews<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> v<span class="token operator">?.</span>meta<span class="token operator">?.</span>affix <span class="token operator">||</span> v<span class="token punctuation">.</span>path <span class="token operator">===</span> view<span class="token punctuation">.</span>path <span class="token operator">||</span> i <span class="token operator">&lt;</span> idx
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
		<span class="token comment">/* 其他若干反 */</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>**下面就是主要内容区功能封装，笔记是对 utils 函数以及组件封装的思路，utils 实现统一记录在 <code>utils-collections</code> **</p> <h2 id="dashboard"><a href="#dashboard" class="header-anchor">#</a> dashboard</h2> <blockquote><p>这部分主要是 （分析页、工作台） 模块</p></blockquote> <h3 id="count-vue"><a href="#count-vue" class="header-anchor">#</a> Count.vue</h3> <blockquote><p>缓动递增/递减数值</p></blockquote> <p><code>props</code> 定义</p> <ul><li><p>duration：动画持续时间</p></li> <li><p>startVal：开始值</p></li> <li><p>endVal：结束值</p></li> <li><p>easingFn：动画函数</p></li></ul> <p>基本实现逻辑：</p> <ol><li>确定初始值、结束值、变化动画函数、动画持续时间，这四个值是最基础能保证功能实现的参数</li> <li>判断初始值与结束值的大小来确定是增还是减</li> <li>判断是否有自定义动画函数，如果没有则采用 <code>requestAnimationFrame</code> 函数参数中的 <code>timestamp</code> 参数，根据 <code>timestamp</code> 每次增加来计算进度条</li></ol> <p>可拓展实现：</p> <ul><li>支持小数类型</li> <li>支持添加千分位分隔符（100,000, 100, 000, 000）</li> <li>支持添加显示前缀后缀</li></ul> <h3 id="echarts-vue"><a href="#echarts-vue" class="header-anchor">#</a> Echarts.vue</h3> <blockquote><p>echarts hooks</p></blockquote> <p><code>props</code> 定义</p> <ul><li>options：<code>echarts</code> 选项</li> <li>width：容器宽度</li> <li>height：容器高度</li></ul> <p>基本实现逻辑：</p> <ol><li><p>定义全局 <code>echarts</code> （注册必要 <code>plugins</code>）</p></li> <li><p>初始化 <code>domRef</code>，根据 props 传参判断是否在挂载完成后初始化 <code>echarts</code></p></li> <li><p>监听选项的变化动态更新 <code>echarts</code>（setOptions）</p></li> <li><p>监听屏幕变化动态缩放 <code>echarts</code>（echartRef.resize）</p></li> <li><p>组件卸载阶段移除屏幕事件监听</p></li></ol> <blockquote><p>对应 <code>vben-admin</code> 里面的实现，有好有坏</p></blockquote> <p>好处在于：将 <code>echarts</code> 初始化以及对应逻辑封装到 <code>vue</code> 文件里面，在使用的时候引入组件即可</p> <p>不好在于：如果需要支持地图（需要注册地图数据），只能去 props 中添加标识然后初始化的时候补充逻辑；而在 <code>vben-admin</code> 中，则是封装为一个 <code>useEcharts</code> ，内部暴露出 <code>echarts</code> 实例、<code>setOptions</code> 等各种属性方法，调用更加灵活。</p> <h2 id="guide"><a href="#guide" class="header-anchor">#</a> guide</h2> <blockquote><p>引导页</p></blockquote> <p>直观来讲就是递进高亮某个区块引导用户熟悉操作流程的过程</p> <p>实现逻辑：</p> <ul><li>使用 <a href="https://github.com/kamranahmedse/driver.js/blob/master/src/events.ts" target="_blank" rel="noopener noreferrer"><code>driver.js</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，封装 <code>useGuide</code>，指定<code></code>options 数组作为步骤列表</li></ul> <h2 id="components"><a href="#components" class="header-anchor">#</a> components</h2> <blockquote><p>组件封装模块，这个也应该是最值得去学习的模块。表格 &amp; 表单这两个封装过程比较复杂，需慢慢消化</p></blockquote> <p>🔑 数据双向绑定</p> <p>代码里面比较显而易见的双向绑定可以参考 “密码强度” —— 密码文本框之间存在一个双向绑定过程。</p> <ul><li>项目的实现逻辑：子组件<code>ref</code> 变量使用 <code>props</code> 作为初始值初始化。子组件数据发生变化时调用 <code>emit</code> 更新父组件数据。和之前预想思路差不多，少了个监听 <code>props</code> 的逻辑，因为子组件状态完全由本身本身，除了初始化其余情况不需要由父组件控制更新。</li></ul> <blockquote><p>对于表单 &amp; 表格，遵循可配置化，即通过 <code>JS</code> 来控制子元素生成</p></blockquote> <h3 id="表单"><a href="#表单" class="header-anchor">#</a> 表单</h3> <p>首先理解通过配置文件去生成整个表单这个概念。我我觉得和之前在工作中使用 JS 变量去控制表单生成无异，关键在：</p> <ul><li>定义好每一项需要传入的参数</li></ul> <p>根据定义好的参数去覆盖不同可能出现场景</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 继承 el-form props</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">FormProps</span> <span class="token keyword">extends</span> <span class="token class-name">Partial<span class="token operator">&lt;</span>ElFormProps<span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token comment">// 表单元数据</span>
  schema<span class="token operator">?</span><span class="token operator">:</span> FormSchema<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 栅格布局标识</span>
  isCol<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">// 表单绑定数据</span>
  model<span class="token operator">?</span><span class="token operator">:</span> Recordable<span class="token punctuation">;</span>
  <span class="token comment">// placeholder 设置标识</span>
  autoSetPlaceholder<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">// 自定义默认插槽标识</span>
  isCustom<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><code>schema</code></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">FormSchema</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 唯一标识
   */</span>
  field<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 标题
   */</span>
  label<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * col组件属性
   */</span>
  colProps<span class="token operator">?</span><span class="token operator">:</span> ColProps<span class="token punctuation">;</span>

  <span class="token comment">/**
   * 表单组件属性
   */</span>
  componentProps<span class="token operator">?</span><span class="token operator">:</span>
    <span class="token operator">|</span> InputComponentProps
    <span class="token operator">|</span> AutocompleteComponentProps
    <span class="token operator">|</span> InputNumberComponentProps
    <span class="token operator">|</span> SelectComponentProps
    <span class="token operator">|</span> SelectV2ComponentProps
    <span class="token operator">|</span> CascaderComponentProps
    <span class="token operator">|</span> SwitchComponentProps
    <span class="token operator">|</span> RateComponentProps
    <span class="token operator">|</span> ColorPickerComponentProps
    <span class="token operator">|</span> TransferComponentProps
    <span class="token operator">|</span> RadioGroupComponentProps
    <span class="token operator">|</span> RadioButtonComponentProps
    <span class="token operator">|</span> DividerComponentProps
    <span class="token operator">|</span> DatePickerComponentProps
    <span class="token operator">|</span> DateTimePickerComponentProps
    <span class="token operator">|</span> TimePickerComponentProps
    <span class="token operator">|</span> InputPasswordComponentProps
    <span class="token operator">|</span> TreeSelectComponentProps
    <span class="token operator">|</span> UploadComponentProps
    <span class="token operator">|</span> JsonEditorProps
    <span class="token operator">|</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * formItem组件属性
   */</span>
  formItemProps<span class="token operator">?</span><span class="token operator">:</span> FormItemProps<span class="token punctuation">;</span>

  <span class="token comment">/**
   * 渲染的组件名称
   */</span>
  component<span class="token operator">?</span><span class="token operator">:</span> ComponentName<span class="token punctuation">;</span>

  <span class="token comment">/**
   * 初始值
   */</span>
  value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 是否隐藏，如果为true，会连同值一同删除，类似v-if
   */</span>
  remove<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 样式隐藏，不会把值一同删掉，类似v-show
   */</span>
  hidden<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * @returns 远程加载下拉项
   */</span>
  optionApi<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><p>从以上属性可以看出，在保证 <code>form-item</code> 以及对应表单控件原 <code>element-plus</code> 属性支持的情况下再拓展一些其他属性。 <code>Input</code> 控件自定义属性类型如下：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">InputComponentProps</span> <span class="token keyword">extends</span> <span class="token class-name">Partial<span class="token operator">&lt;</span>InputProps<span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  rows<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  on<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    blur<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> FocusEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    focus<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> FocusEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    change<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    clear<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    input<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  slots<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    prefix<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    suffix<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    prepend<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    append<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  style<span class="token operator">?</span><span class="token operator">:</span> CSSProperties<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>把事件封装在 on &amp; 插槽封装在 slots 中是因为 <strong>JSX</strong> 需要这样的数据结构</p> <h3 id="表格"><a href="#表格" class="header-anchor">#</a> 表格</h3> <h3 id="编辑器"><a href="#编辑器" class="header-anchor">#</a> 编辑器</h3> <blockquote><p>包括富文本编辑器 &amp; JSON 编辑器</p></blockquote> <h4 id="富文本编辑器"><a href="#富文本编辑器" class="header-anchor">#</a> 富文本编辑器</h4> <p>封装 <code>@wangeditor/editor</code>、<code>@wangeditor/editor-for-vue</code></p> <h4 id="json-编辑器"><a href="#json-编辑器" class="header-anchor">#</a> JSON 编辑器</h4> <p>严格意义上并不算是编辑器，可以理解为是一个 <code>JSON</code> 格式化工具，基于 <code>vue-json-pretty</code> 实现</p> <h3 id="图片预览"><a href="#图片预览" class="header-anchor">#</a> 图片预览</h3> <blockquote><p><code>element-plus</code> 自带有一个 <code>ElImageViewer</code> 组件</p></blockquote> <p>封装思路：</p> <ol><li>定义一个 <code>createViewer</code> 函数，传入 <code>urlLists</code></li> <li>在触发预览操作的时候，使用 <code>render</code> 函数动态创建 <code>imageViewer</code></li></ol> <ul><li><p>之前想法：<code>imageViewer</code> 作为一个组件写入夫组件，通过在父组件维护一个 <code>isShow</code> 变量控制显示隐藏；</p></li> <li><p>目前实现：每次触发预览只需要调用 <code>createViewer</code> 函数即可，父组件不再需要维护控制变量（解耦）。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> render<span class="token punctuation">,</span> createVNode <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createViewer</span><span class="token punctuation">(</span>urlList<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> vnode <span class="token operator">=</span> <span class="token function">createVNode</span><span class="token punctuation">(</span>ImageViewer<span class="token punctuation">,</span> propsData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 挂载 vnode 到 container 上</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul> <h3 id="图标"><a href="#图标" class="header-anchor">#</a> 图标</h3> <blockquote><p>图标和图标选择器可以纳入一起学习</p></blockquote> <p>阅读完有几个疑问：</p> <ol><li>项目中包括了三个不同的图标来源，但是没看到具体如何去引入相关 CSS 资源</li> <li>如何做到图标的按需打包</li></ol> <p>🔑 Answer</p> <p>使用 <code>@iconify/vue</code> —— 包含若干 <a href="https://icon-sets.iconify.design/" target="_blank" rel="noopener noreferrer">图标集<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <img src="/home/jzy/Documents/markdown/source-code/vue-element-plus-admin.docs.assets/image-20231115231518237.png" style="display:block;margin:auto;"> <p>​ 一般来说 <code>api-provider</code> 可忽略，<code>icon-prefix</code> 代表是哪个图标集合，<code>icon-name</code> 表示具体的图标</p> <p>而项目中之所以能渲染三个不同类型的图标库也是得益于此</p> <h3 id="二维码"><a href="#二维码" class="header-anchor">#</a> 二维码</h3> <blockquote><p>基于 <code>qrcode</code> 实现，具体使用的时候可以参考 <a href="https://www.npmjs.com/package/qrcode" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="高亮"><a href="#高亮" class="header-anchor">#</a> 高亮</h3> <blockquote><p>高亮的指的是对指定文段中的部分短语或句子进行高亮显示（与普通文段作颜色上区分）</p></blockquote> <p>实现原理：</p> <ol><li><p>高亮组件渲染函数，接收 props</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">highlightPhrase</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token literal-property property">highlightColor</span><span class="token operator">:</span> string
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>传入需要高亮的内容列表，建立正则匹配内容并替换为 ，index 代表索引</p></li> <li><p>按 切割文本，得到文段分组。</p></li> <li><p>遍历文段分组，如果单一分组类型为数字说明为需要高亮的短语（<code>hightlightPhrase[index]</code>）</p></li></ol> <h3 id="密码强度"><a href="#密码强度" class="header-anchor">#</a> 密码强度</h3> <blockquote><p>1-5 五个等级，给出当前密码强度</p></blockquote> <p>实现原理：</p> <ol><li><p>原生 <code>CSS</code> 绘制原始密码强度 UI。借助 <code>::before</code> &amp; <code>::after</code> 伪类，以 <code>border-left</code> &amp; <code>border-right</code> 作为切割点，切割出四个缺口形成五个等级 <code>step</code></p></li> <li><p><code>zxcvbn</code> 计算密码强度</p></li> <li><p><code>CSS</code> 属性选择器设置在不同 <code>level</code> 下背景色</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">div[data-score=&quot;0&quot;]</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 20%<span class="token punctuation">;</span> <span class="token comment">/* 40% 60% 80% 100% */</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--el-color-danger<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ol> <h3 id="瀑布流"><a href="#瀑布流" class="header-anchor">#</a> 瀑布流</h3> <blockquote><p>列宽度相同，不同列纵向元素高度不尽相同</p></blockquote> <p>功能：</p> <ul><li>能根据屏幕响应式进行布局</li> <li>首屏如果加载不完则自动继续加载（滚动加载）</li></ul> <p>实现原理（基于绝对定位）：</p> <ol><li><p>首先根据屏幕宽度确定有多少列（ <code>Math.floor(document.documentElement.clientWdith / preWidth)</code> ）</p></li> <li><p>遍历数据，分为两种情况</p> <ol><li><p>第一行所有列未填满：加入待渲染列表；</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/*
  i: 第 i 列
  preWidth: 列宽度
  gap: 元素间距
*/</span>
renderLists<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  left<span class="token operator">:</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>preWidth <span class="token operator">+</span> gap<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 往后推一列</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>第一行所有列已填满：需要计算哪一列高度最小（逻辑上将下一个元素插入到当前列，通过 <code>top</code> 、<code>left</code> 描述这个过程）</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/*
  i: 第 i 列
  minHeight: 最小高度
*/</span>
renderLists<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  top<span class="token operator">:</span> minHeight <span class="token operator">+</span> gap<span class="token punctuation">,</span>
  left<span class="token operator">:</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>preWidth <span class="token operator">+</span> gap<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ol></li> <li><p>计算容器高度</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>wrapperWidth <span class="token operator">=</span> cols <span class="token operator">*</span> <span class="token punctuation">(</span>preWidth <span class="token operator">+</span> gap<span class="token punctuation">)</span> <span class="token operator">-</span> gap<span class="token punctuation">;</span>
wrapperHeigth <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">...</span>heights<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>滚动加载</p> <p>使用到了 <code>@vueuse/core</code> 里面的 <code>useIntersectionObserver</code>。当加载更多的容器进入视口时触发父组件数据获取函数，通过 <code>loading</code> &amp; <code>end</code> 变量来控制加载的时机。列表组件可以单纯地理解为是一个展示组件，数据获取 &amp; 状态控制均为外部控制。</p></li></ol></div> <footer class="page-edit page-editor"><div class="edit-link"><a href="https://github.com/jzyismylover/ubuntu-markdown/edit/docs/source/vue-element-plus-admin.docs.md" target="_blank" rel="noopener noreferrer">完善页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">3/17/2024, 9:24:20 AM</span></div></footer> <!----></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">vue-element-plus-admin</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/markdown/vue-element-plus-admin-docs/#layout" class="toc-sidebar-link">layout</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#菜单" class="toc-sidebar-link">菜单</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/vue-element-plus-admin-docs/#后端生成" class="toc-sidebar-link">后端生成</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/vue-element-plus-admin-docs/#前端生成" class="toc-sidebar-link">前端生成</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/vue-element-plus-admin-docs/#渲染菜单" class="toc-sidebar-link">渲染菜单</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#工具栏" class="toc-sidebar-link">工具栏</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/vue-element-plus-admin-docs/#面包屑" class="toc-sidebar-link">面包屑</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#路由标签页" class="toc-sidebar-link">路由标签页</a></li></ul></li><li><a href="/markdown/vue-element-plus-admin-docs/#dashboard" class="toc-sidebar-link">dashboard</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#count-vue" class="toc-sidebar-link">Count.vue</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#echarts-vue" class="toc-sidebar-link">Echarts.vue</a></li></ul></li><li><a href="/markdown/vue-element-plus-admin-docs/#guide" class="toc-sidebar-link">guide</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/vue-element-plus-admin-docs/#components" class="toc-sidebar-link">components</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#表单" class="toc-sidebar-link">表单</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#表格" class="toc-sidebar-link">表格</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#编辑器" class="toc-sidebar-link">编辑器</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/vue-element-plus-admin-docs/#富文本编辑器" class="toc-sidebar-link">富文本编辑器</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/vue-element-plus-admin-docs/#json-编辑器" class="toc-sidebar-link">JSON 编辑器</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#图片预览" class="toc-sidebar-link">图片预览</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#图标" class="toc-sidebar-link">图标</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#二维码" class="toc-sidebar-link">二维码</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#高亮" class="toc-sidebar-link">高亮</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#密码强度" class="toc-sidebar-link">密码强度</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/vue-element-plus-admin-docs/#瀑布流" class="toc-sidebar-link">瀑布流</a></li></ul></li></ul></div></div></div></div></div>  <div></div></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><!----></div></div>
    <script src="/markdown/assets/js/app.085aa012.js" defer></script><script src="/markdown/assets/js/2.773263cd.js" defer></script><script src="/markdown/assets/js/85.c7258f01.js" defer></script>
  </body>
</html>
