<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>electron-builder | Mr.Jiang-技术博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="">
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?2675818a983a3131404cee835018f016";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script>
    <meta name="description" content="学习&amp;工作-技术积累">
    
    <link rel="preload" href="/markdown/assets/css/0.styles.5474aed4.css" as="style"><link rel="preload" href="/markdown/assets/js/app.085aa012.js" as="script"><link rel="preload" href="/markdown/assets/js/2.773263cd.js" as="script"><link rel="preload" href="/markdown/assets/js/54.3535db37.js" as="script"><link rel="prefetch" href="/markdown/assets/js/1.50bc9635.js"><link rel="prefetch" href="/markdown/assets/js/10.121e7e8f.js"><link rel="prefetch" href="/markdown/assets/js/11.5205ffab.js"><link rel="prefetch" href="/markdown/assets/js/12.fef29d74.js"><link rel="prefetch" href="/markdown/assets/js/13.b581db50.js"><link rel="prefetch" href="/markdown/assets/js/14.07202c28.js"><link rel="prefetch" href="/markdown/assets/js/15.9aedb95a.js"><link rel="prefetch" href="/markdown/assets/js/16.dd97e264.js"><link rel="prefetch" href="/markdown/assets/js/17.8eb943fb.js"><link rel="prefetch" href="/markdown/assets/js/18.942cde78.js"><link rel="prefetch" href="/markdown/assets/js/19.44710683.js"><link rel="prefetch" href="/markdown/assets/js/20.22d46747.js"><link rel="prefetch" href="/markdown/assets/js/21.aa8b4011.js"><link rel="prefetch" href="/markdown/assets/js/22.b40024cc.js"><link rel="prefetch" href="/markdown/assets/js/23.ace5d346.js"><link rel="prefetch" href="/markdown/assets/js/24.2405d60a.js"><link rel="prefetch" href="/markdown/assets/js/25.c08a85e2.js"><link rel="prefetch" href="/markdown/assets/js/26.c4c5f267.js"><link rel="prefetch" href="/markdown/assets/js/27.b91e5849.js"><link rel="prefetch" href="/markdown/assets/js/28.b80c3633.js"><link rel="prefetch" href="/markdown/assets/js/29.594ec447.js"><link rel="prefetch" href="/markdown/assets/js/3.9d4223ad.js"><link rel="prefetch" href="/markdown/assets/js/30.324e278d.js"><link rel="prefetch" href="/markdown/assets/js/31.43dc2191.js"><link rel="prefetch" href="/markdown/assets/js/32.3fb01abd.js"><link rel="prefetch" href="/markdown/assets/js/33.5a2693b9.js"><link rel="prefetch" href="/markdown/assets/js/34.637d4661.js"><link rel="prefetch" href="/markdown/assets/js/35.eccfebaa.js"><link rel="prefetch" href="/markdown/assets/js/36.c13df5f5.js"><link rel="prefetch" href="/markdown/assets/js/37.9890e89c.js"><link rel="prefetch" href="/markdown/assets/js/38.b33827f2.js"><link rel="prefetch" href="/markdown/assets/js/39.3a1ace37.js"><link rel="prefetch" href="/markdown/assets/js/4.27d6f5b1.js"><link rel="prefetch" href="/markdown/assets/js/40.4396d4c2.js"><link rel="prefetch" href="/markdown/assets/js/41.afe775e0.js"><link rel="prefetch" href="/markdown/assets/js/42.19b2951c.js"><link rel="prefetch" href="/markdown/assets/js/43.7c3256ea.js"><link rel="prefetch" href="/markdown/assets/js/44.7da308e4.js"><link rel="prefetch" href="/markdown/assets/js/45.89b2fd21.js"><link rel="prefetch" href="/markdown/assets/js/46.e817e45d.js"><link rel="prefetch" href="/markdown/assets/js/47.c56ee626.js"><link rel="prefetch" href="/markdown/assets/js/48.59541039.js"><link rel="prefetch" href="/markdown/assets/js/49.bc7ad96a.js"><link rel="prefetch" href="/markdown/assets/js/5.2637f2cc.js"><link rel="prefetch" href="/markdown/assets/js/50.9d0dc446.js"><link rel="prefetch" href="/markdown/assets/js/51.4d949834.js"><link rel="prefetch" href="/markdown/assets/js/52.90aa4f80.js"><link rel="prefetch" href="/markdown/assets/js/53.67b77129.js"><link rel="prefetch" href="/markdown/assets/js/55.9efbe9e5.js"><link rel="prefetch" href="/markdown/assets/js/56.e8aa37ba.js"><link rel="prefetch" href="/markdown/assets/js/57.af66ff8f.js"><link rel="prefetch" href="/markdown/assets/js/58.0415674f.js"><link rel="prefetch" href="/markdown/assets/js/59.b09373ca.js"><link rel="prefetch" href="/markdown/assets/js/6.61bacfb8.js"><link rel="prefetch" href="/markdown/assets/js/60.d07cb515.js"><link rel="prefetch" href="/markdown/assets/js/61.ec2b2da7.js"><link rel="prefetch" href="/markdown/assets/js/62.44a5a0b8.js"><link rel="prefetch" href="/markdown/assets/js/63.09e39adc.js"><link rel="prefetch" href="/markdown/assets/js/64.b9ee085d.js"><link rel="prefetch" href="/markdown/assets/js/65.026450b0.js"><link rel="prefetch" href="/markdown/assets/js/66.a3571972.js"><link rel="prefetch" href="/markdown/assets/js/67.5a8616c4.js"><link rel="prefetch" href="/markdown/assets/js/68.6fdda787.js"><link rel="prefetch" href="/markdown/assets/js/69.691ff5d7.js"><link rel="prefetch" href="/markdown/assets/js/7.32a4bd87.js"><link rel="prefetch" href="/markdown/assets/js/70.b401009e.js"><link rel="prefetch" href="/markdown/assets/js/71.6b3bcefe.js"><link rel="prefetch" href="/markdown/assets/js/72.dcd8145e.js"><link rel="prefetch" href="/markdown/assets/js/73.cc81c046.js"><link rel="prefetch" href="/markdown/assets/js/74.856f40f0.js"><link rel="prefetch" href="/markdown/assets/js/75.746590de.js"><link rel="prefetch" href="/markdown/assets/js/76.8ddba5b5.js"><link rel="prefetch" href="/markdown/assets/js/77.16644476.js"><link rel="prefetch" href="/markdown/assets/js/78.e89fc885.js"><link rel="prefetch" href="/markdown/assets/js/79.1193b665.js"><link rel="prefetch" href="/markdown/assets/js/80.9475cd89.js"><link rel="prefetch" href="/markdown/assets/js/81.8d99d275.js"><link rel="prefetch" href="/markdown/assets/js/82.80eb3e2f.js"><link rel="prefetch" href="/markdown/assets/js/83.fe14141e.js"><link rel="prefetch" href="/markdown/assets/js/84.9647a2db.js"><link rel="prefetch" href="/markdown/assets/js/85.c7258f01.js"><link rel="prefetch" href="/markdown/assets/js/86.1a5782f4.js"><link rel="prefetch" href="/markdown/assets/js/87.e7354607.js"><link rel="prefetch" href="/markdown/assets/js/vendors~docsearch.54f2532f.js">
    <link rel="stylesheet" href="/markdown/assets/css/0.styles.5474aed4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/markdown/" class="home-link router-link-active"><img src="/markdown/logo.png" alt="Mr.Jiang-技术博客" class="logo"> <span class="site-name can-hide">Mr.Jiang-技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/jzyismylover/ubuntu-markdown" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/jzyismylover/ubuntu-markdown" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/markdown/fronted/" class="sidebar-link">前端知识概述</a></li><li><a href="/markdown/git/" class="sidebar-link">版本控制</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/markdown/typescript/" class="sidebar-link">Typescript</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Electron</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/markdown/electron/" class="sidebar-link">技术背景</a></li><li><a href="/markdown/electron-builder/" aria-current="page" class="active sidebar-link">electron-builder</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/markdown/electron-builder/#settings" class="sidebar-link">settings</a></li><li class="sidebar-sub-header"><a href="/markdown/electron-builder/#macos" class="sidebar-link">macos</a></li><li class="sidebar-sub-header"><a href="/markdown/electron-builder/#windows" class="sidebar-link">windows</a></li><li class="sidebar-sub-header"><a href="/markdown/electron-builder/#linux" class="sidebar-link">linux</a></li><li class="sidebar-sub-header"><a href="/markdown/electron-builder/#upgrade" class="sidebar-link">upgrade</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端监控</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="content"><div class="content-wrapper" style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="electron-builder"><a href="#electron-builder" class="header-anchor">#</a> electron-builder</h1> <p>electron-builder：是一个可以跨平台打包桌面应用的打包工具，且支持应用程序的自动更新，支持打包格式</p> <ul><li>all platform：7z, zip, tar.xz, tar.gz, tar.lz, tar.bz2, dir</li> <li>macos：dmg, pkg, mas, mas-dev</li> <li>linux：deb, rpm, apk, pacman, snap</li> <li>windows: nsis, portable, appx</li></ul> <h2 id="settings"><a href="#settings" class="header-anchor">#</a> settings</h2> <p>electron-build 可通过传入 options 定义打包行为，可配置通用选项如下：</p> <ul><li><p>appid：应用 id</p></li> <li><p>productName：应用打包名( <code>不允许出现空格和特殊字符</code>)</p></li> <li><p>copyright：著作权( <code>Copyright © year ${author}</code> )</p></li> <li><p>beforePack(Function)：生成应用程序包前执行的回调函数</p></li> <li><p>afterPack(Function)：生成应用程序包后执行的回调函数</p></li> <li><p>directives(Object)：配置输出目录、资源目录</p></li> <li><p>……</p></li></ul> <h2 id="macos"><a href="#macos" class="header-anchor">#</a> macos</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> macOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mac</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'./resources/icons/icon.icns'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">category</span><span class="token operator">:</span> <span class="token string">'public.app-category.music'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dmg</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">window</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
      <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">contents</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 定义图标位置</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">106</span><span class="token punctuation">,</span>
        <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">252</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'LX Music'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">490</span><span class="token punctuation">,</span>
        <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">252</span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'link'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/Applications'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token function">mac</span><span class="token punctuation">(</span><span class="token parameter">arch<span class="token punctuation">,</span> packageType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>packageType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'dmg'</span><span class="token operator">:</span>
        macOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}-\${version}-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">mac</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'dmg'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> macOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Unknown package type: '</span> <span class="token operator">+</span> packageType<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="windows"><a href="#windows" class="header-anchor">#</a> windows</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> winOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">win</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'./resources/icons/icon.ico'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">legalTrademarks</span><span class="token operator">:</span> <span class="token string">'lyswhut'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">nsis</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">oneClick</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否提供一键安装</span>
    <span class="token literal-property property">language</span><span class="token operator">:</span> <span class="token string">'2052'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">allowToChangeInstallationDirectory</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否允许用户更改安装目录。</span>
    <span class="token literal-property property">license</span><span class="token operator">:</span> <span class="token string">'./licenses/license.rtf'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">shortcutName</span><span class="token operator">:</span> <span class="token string">'LX Music'</span><span class="token punctuation">,</span> <span class="token comment">// 快捷方式名称</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>windows 中比较常见是通过 .exe 启动安装程序安装应用.  nsis 可以通过一些选项帮助构建一个安装启动程序.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token function">win</span><span class="token punctuation">(</span><span class="token parameter">arch<span class="token punctuation">,</span> packageType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>packageType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'setup'</span><span class="token operator">:</span> <span class="token comment">// 安装程序</span>
        winOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}-v\${version}-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-Setup.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">win</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'nsis'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> winOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">case</span> <span class="token string">'green'</span><span class="token operator">:</span>
        winOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}-v\${version}-win_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-green.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">win</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'7z'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> winOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">case</span> <span class="token string">'win7_green'</span><span class="token operator">:</span>
        winOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}-v\${version}-win7_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-green.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">win</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'7z'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> winOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">case</span> <span class="token string">'portable'</span><span class="token operator">:</span>
        winOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}-v\${version}-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-portable.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">win</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'portable'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> winOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Unknown package type: '</span> <span class="token operator">+</span> packageType<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="linux"><a href="#linux" class="header-anchor">#</a> linux</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> linuxOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">linux</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">maintainer</span><span class="token operator">:</span> <span class="token string">'lyswhut &lt;lyswhut@qq.com&gt;'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">'./resources/icons'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">category</span><span class="token operator">:</span> <span class="token string">'Utility;AudioVideo;Audio;Player;Music;'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">desktop</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">Name</span><span class="token operator">:</span> <span class="token string">'LX Music'</span><span class="token punctuation">,</span>
      <span class="token string-property property">'Name[zh_CN]'</span><span class="token operator">:</span> <span class="token string">'LX Music'</span><span class="token punctuation">,</span>
      <span class="token string-property property">'Name[zh_TW]'</span><span class="token operator">:</span> <span class="token string">'LX Music'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">Encoding</span><span class="token operator">:</span> <span class="token string">'UTF-8'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">MimeType</span><span class="token operator">:</span> <span class="token string">'x-scheme-handler/lxmusic'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">StartupNotify</span><span class="token operator">:</span> <span class="token string">'false'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">appImage</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">license</span><span class="token operator">:</span> <span class="token string">'./licenses/license_zh.txt'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">category</span><span class="token operator">:</span> <span class="token string">'Utility;AudioVideo;Audio;Player;Music;'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>linux 有很多不同发行版，像 debian、archlinux、redhat，不同发行版基于不同包管理器管理应用包安装</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token function">linux</span><span class="token punctuation">(</span><span class="token parameter">arch<span class="token punctuation">,</span> packageType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>packageType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'deb'</span><span class="token operator">:</span>
        linuxOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}_\${version}_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch <span class="token operator">==</span> <span class="token string">'x64'</span> <span class="token operator">?</span> <span class="token string">'amd64'</span> <span class="token operator">:</span> arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">linux</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'deb'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> linuxOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">case</span> <span class="token string">'appImage'</span><span class="token operator">:</span>
        linuxOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}_\${version}_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">linux</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'AppImage'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> linuxOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">case</span> <span class="token string">'pacman'</span><span class="token operator">:</span>
        linuxOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}_\${version}_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">linux</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'pacman'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> linuxOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">case</span> <span class="token string">'rpm'</span><span class="token operator">:</span>
        linuxOptions<span class="token punctuation">.</span>artifactName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\${productName}-\${version}.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.\${ext}</span><span class="token template-punctuation string">`</span></span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">buildOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">linux</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'rpm'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> linuxOptions<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Unknown package type: '</span> <span class="token operator">+</span> packageType<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="upgrade"><a href="#upgrade" class="header-anchor">#</a> upgrade</h2> <p>electron 更新分为全量更新 &amp; 增量更新</p> <ul><li>全量更新：一般用于大版本更新（存在破坏性改动），需要重新下载整个安装包执行应用安装程序</li> <li>增量更新：一般用于小版本更新，下载部分数据组装成新的安装包</li></ul> <h3 id="全量更新"><a href="#全量更新" class="header-anchor">#</a> 全量更新</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token number">0.0</span><span class="token punctuation">.</span>1ZHANGZHANG
<span class="token literal-property property">files</span><span class="token operator">:</span>
  <span class="token operator">-</span> url<span class="token operator">:</span> data<span class="token operator">-</span>platform_setup_0<span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">.</span>exe
    <span class="token literal-property property">sha512</span><span class="token operator">:</span> xI8sHN39xAwKhKGD4k21m6<span class="token operator">/</span><span class="token constant">C</span><span class="token operator">/</span>Zap9H3OMjvdWeeCqfmjGe6TA<span class="token operator">+</span>6lEYLeI9woaJmNIQM0r90hhmFObWC9ejFbjQ<span class="token operator">==</span>
    <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">57384371</span>
<span class="token literal-property property">path</span><span class="token operator">:</span> data<span class="token operator">-</span>platform_setup_0<span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">.</span>exe
<span class="token literal-property property">sha512</span><span class="token operator">:</span> xI8sHN39xAwKhKGD4k21m6<span class="token operator">/</span><span class="token constant">C</span><span class="token operator">/</span>Zap9H3OMjvdWeeCqfmjGe6TA<span class="token operator">+</span>6lEYLeI9woaJmNIQM0r90hhmFObWC9ejFbjQ<span class="token operator">==</span>
<span class="token literal-property property">releaseDate</span><span class="token operator">:</span> <span class="token string">'2021-05-29T15:00:33.861Z'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>version：记录最新版本号</li> <li>sha512：安装包 sha512</li> <li>path：安装包下载链接</li></ul> <p>解决思路：应用启动的时候获取服务器 *.yml 文件，对比当前本地版本，如果有版本更新则从服务器获取新的安装包。</p> <h3 id="增量更新"><a href="#增量更新" class="header-anchor">#</a> 增量更新</h3> <blockquote><p>增量更新有两种：asar、blockmap</p></blockquote> <h4 id="asar"><a href="#asar" class="header-anchor">#</a> asar</h4> <h4 id="blockmap"><a href="#blockmap" class="header-anchor">#</a> blockmap</h4> <h1 id="build"><a href="#build" class="header-anchor">#</a> build</h1> <blockquote><p>electron-build 仅仅是作为生成对应平台对应架构二进制程序包的工具，并不能帮助我们打包编译、打包前端项目，这一套流程还是需要借助 webpack / vite 等一些前端领域的构建工具</p></blockquote> <p>应用 build 过程可以理解为是应用源码构建过程，分为两个阶段：</p> <ul><li>主进程构建：构建入口为 electron 启动文件</li> <li>渲染进程构建：构建入口为 main.js</li></ul> <h1 id="all"><a href="#all" class="header-anchor">#</a> all</h1> <p>目前其实有一些已经集成好的工具可以使用，<code>vite-electron-builder</code>、<code>electron-vue-vite</code>…… 同时也作为项目启动的脚手架，通过暴露一些配置选项帮助定制 build &amp; pack 的行为，自行编写可参考 <code>lx-music</code>  —— 基于 webpack 使用多线程并行打包</p></div> <footer class="page-edit page-editor"><div class="edit-link"><a href="https://github.com/jzyismylover/ubuntu-markdown/edit/docs/fronted/electron/electron-builder.md" target="_blank" rel="noopener noreferrer">完善页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">3/17/2024, 9:24:20 AM</span></div></footer> <div class="page-nav page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/markdown/electron/" class="prev">
        技术背景
      </a></span> <span class="next"><a href="/markdown/capture/">
        前端错误捕获
      </a>
      →
    </span></p></div></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">electron-builder</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/markdown/electron-builder/#settings" class="toc-sidebar-link">settings</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/electron-builder/#macos" class="toc-sidebar-link">macos</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/electron-builder/#windows" class="toc-sidebar-link">windows</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/electron-builder/#linux" class="toc-sidebar-link">linux</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/markdown/electron-builder/#upgrade" class="toc-sidebar-link">upgrade</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/markdown/electron-builder/#全量更新" class="toc-sidebar-link">全量更新</a></li><li class="toc-sidebar-sub-header"><a href="/markdown/electron-builder/#增量更新" class="toc-sidebar-link">增量更新</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/electron-builder/#asar" class="toc-sidebar-link">asar</a></li><li class="toc-sidebar-sub-header toc-sidebar-depth-4"><a href="/markdown/electron-builder/#blockmap" class="toc-sidebar-link">blockmap</a></li></ul></li></ul></div></div></div></div></div>  <div></div></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><!----></div></div>
    <script src="/markdown/assets/js/app.085aa012.js" defer></script><script src="/markdown/assets/js/2.773263cd.js" defer></script><script src="/markdown/assets/js/54.3535db37.js" defer></script>
  </body>
</html>
